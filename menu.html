<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Speranza Pizza</title>
  <link rel="shortcut icon" href="images/favicon.png">
  <link rel="stylesheet" href="css/bootstrap.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-nice-select/1.1.0/css/nice-select.min.css">
  <link rel="stylesheet" href="css/font-awesome.min.css">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/responsive.css">

  <style>
    /* Dark theme color variables */
    :root {
      --dark-bg: #1a1a1a;
      --darker-bg: #0f0f0f;
      --card-bg: #2d2d2d;
      --text-primary: #ffffff;
      --text-secondary: #b0b0b0;
      --accent-color: #ff6b35;
      --accent-hover: #ff5722;
      --border-color: #404040;
      --shadow-dark: rgba(0, 0, 0, 0.5);
    }

    /* Dark theme for body */
    body.sub_page {
      background: var(--dark-bg);
      color: var(--text-primary);
    }

    /* Dark theme for food section */
    .food_section {
      background: var(--dark-bg);
    }

    .heading_container h2 {
      color: var(--text-primary);
    }

    .floating-cart {
      position: fixed;
      top: 50%;
      right: -350px;
      transform: translateY(-50%);
      width: 350px;
      background: var(--card-bg);
      box-shadow: -10px 0 30px var(--shadow-dark);
      border-radius: 15px 0 0 15px;
      z-index: 1000;
      transition: right 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      max-height: 85vh;
      overflow-y: auto;
      border: 1px solid var(--border-color);
    }

    .floating-cart.open {
      right: 0;
    }

    .cart-toggle {
      position: absolute;
      left: -50px;
      top: 20px;
      background: linear-gradient(135deg, var(--accent-color), var(--accent-hover));
      color: white;
      padding: 15px;
      border-radius: 50% 0 0 50%;
      cursor: pointer;
      box-shadow: -5px 0 20px var(--shadow-dark);
      transition: all 0.3s ease;
    }

    .cart-toggle:hover {
      transform: translateX(-5px);
      box-shadow: -8px 0 25px var(--shadow-dark);
    }

    .cart-header {
      background: linear-gradient(135deg, var(--accent-color), var(--accent-hover));
      color: white;
      padding: 20px;
      border-radius: 15px 0 0 0;
      text-align: center;
    }

    .cart-item {
      padding: 15px 20px;
      border-bottom: 1px solid var(--border-color);
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: var(--card-bg);
      transition: background 0.3s ease;
    }

    .cart-item:hover {
      background: #3a3a3a;
    }

    .cart-item-info {
      flex: 1;
    }

    .cart-item-name {
      font-weight: bold;
      font-size: 16px;
      color: var(--text-primary);
      margin-bottom: 5px;
    }

    .cart-item-price {
      color: var(--text-secondary);
      font-size: 14px;
    }

    .quantity-controls {
      display: flex;
      align-items: center;
      gap: 8px;
      margin: 8px 0;
    }

    .quantity-btn {
      background: linear-gradient(135deg, var(--accent-color), var(--accent-hover));
      color: white;
      border: none;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 14px;
      font-weight: bold;
      transition: all 0.3s ease;
    }

    .quantity-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 4px 15px rgba(255, 107, 53, 0.4);
    }

    .quantity-display {
      min-width: 35px;
      text-align: center;
      font-weight: bold;
      color: var(--text-primary);
      background: var(--darker-bg);
      padding: 5px 10px;
      border-radius: 15px;
    }

    .remove-item {
      background: linear-gradient(135deg, #dc3545, #c82333);
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 15px;
      cursor: pointer;
      font-size: 12px;
      transition: all 0.3s ease;
    }

    .remove-item:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 15px rgba(220, 53, 69, 0.4);
    }

    .cart-footer {
      padding: 20px;
      background: var(--darker-bg);
      border-radius: 0 0 15px 0;
      border-top: 1px solid var(--border-color);
    }

    .cart-total {
      font-weight: bold;
      font-size: 20px;
      margin-bottom: 15px;
      color: var(--accent-color);
      text-align: center;
    }

    .cart-count {
      position: absolute;
      top: -10px;
      right: -10px;
      background: linear-gradient(135deg, #dc3545, #c82333);
      color: white;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      font-size: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      border: 2px solid var(--card-bg);
    }

    .add-to-cart-btn {
      background: linear-gradient(135deg, var(--accent-color), var(--accent-hover));
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 25px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
    }

    .add-to-cart-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(255, 107, 53, 0.4);
      background: linear-gradient(135deg, var(--accent-hover), #e64a19);
    }

    /* Enhanced product card styles - 3 per row */
    .product-card {
      background: var(--card-bg);
      border-radius: 20px;
      box-shadow: 0 8px 30px var(--shadow-dark);
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      margin-bottom: 30px;
      overflow: hidden;
      border: 1px solid var(--border-color);
      position: relative;
    }

    .product-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--accent-color), var(--accent-hover));
      transform: scaleX(0);
      transition: transform 0.3s ease;
    }

    .product-card:hover::before {
      transform: scaleX(1);
    }

    .product-card:hover {
      transform: translateY(-10px);
      box-shadow: 0 20px 40px var(--shadow-dark);
      border-color: var(--accent-color);
    }

    .product-card .img-box {
      width: 100%;
      overflow: hidden;
      position: relative;
      background: var(--darker-bg);
      display: flex;
      align-items: center;
      justify-content: center;
      aspect-ratio: 4 / 3;
      /* keeps a responsive box */
      max-height: 360px;
    }

    /* subtle overlay */
    .product-card .img-box::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(45deg, transparent, rgba(255, 107, 53, 0.1));
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .product-card:hover .img-box::after {
      opacity: 1;
    }

    /* Make the image take the full width of the container and stay responsive */
    .product-card .img-box img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      /* use cover to fill the box; switch to 'contain' if you prefer no crop */
      display: block;
      transition: transform 0.4s ease;
    }

    .product-card:hover .img-box img {
      transform: scale(1.05);
    }

    /* smaller screens: reduce max height so images stay proportional */
    @media (max-width: 768px) {
      .product-card .img-box {
        max-height: 260px;
        aspect-ratio: 16/11;
      }
    }

    .product-card .detail-box {
      padding: 25px;
      background: var(--card-bg);
    }

    .product-card .detail-box h5 {
      font-weight: 700;
      font-size: 20px;
      margin-bottom: 12px;
      color: var(--text-primary);
      transition: color 0.3s ease;
    }

    .product-card:hover .detail-box h5 {
      color: var(--accent-color);
    }

    .product-card .detail-box p {
      color: var(--text-secondary);
      font-size: 14px;
      margin-bottom: 20px;
      line-height: 1.6;
    }

    .product-card .options {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-top: 15px;
      border-top: 1px solid var(--border-color);
    }

    .product-card .options h6 {
      font-size: 24px;
      font-weight: 800;
      color: var(--accent-color);
      margin: 0;
      text-shadow: 0 2px 4px rgba(255, 107, 53, 0.3);
    }

    /* Enhanced filter menu styles */
    .filters_menu {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 20px;
      margin-bottom: 50px;
      padding: 0;
      list-style: none;
    }

    .filters_menu li {
      background: var(--card-bg);
      color: var(--text-secondary);
      padding: 15px 25px;
      border-radius: 30px;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 2px solid var(--border-color);
      font-weight: 600;
      position: relative;
      overflow: hidden;
    }

    .filters_menu li::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 107, 53, 0.1), transparent);
      transition: left 0.5s ease;
    }

    .filters_menu li:hover::before {
      left: 100%;
    }

    .filters_menu li:hover,
    .filters_menu li.active {
      background: linear-gradient(135deg, var(--accent-color), var(--accent-hover));
      color: white;
      border-color: var(--accent-color);
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(255, 107, 53, 0.4);
    }

    /* 3 cards per row responsive grid */
    .col-xl-4-custom {
      flex: 0 0 33.333333%;
      max-width: 33.333333%;
      padding: 0 15px;
    }

    @media (max-width: 1200px) {
      .col-xl-4-custom {
        flex: 0 0 50%;
        max-width: 50%;
      }
    }

    @media (max-width: 768px) {
      .col-xl-4-custom {
        flex: 0 0 100%;
        max-width: 100%;
      }

      .floating-cart {
        width: 300px;
        right: -300px;
      }
    }

    /* Dark scrollbar */
    .floating-cart::-webkit-scrollbar {
      width: 8px;
    }

    .floating-cart::-webkit-scrollbar-track {
      background: var(--darker-bg);
    }

    .floating-cart::-webkit-scrollbar-thumb {
      background: var(--accent-color);
      border-radius: 4px;
    }

    .floating-cart::-webkit-scrollbar-thumb:hover {
      background: var(--accent-hover);
    }

    /* Empty cart styling */
    #empty-cart {
      color: var(--text-secondary);
      background: var(--darker-bg);
      border-radius: 10px;
      margin: 10px;
    }

    /* Bouton panier flottant en bas */
    .floating-cart-button-bottom {
      position: fixed;
      bottom: 30px;
      right: 30px;
      width: 70px;
      height: 70px;
      background: linear-gradient(135deg, var(--accent-color), var(--accent-hover));
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 8px 25px var(--shadow-dark);
      transition: all 0.3s ease;
      z-index: 1001;
      border: none;
    }

    .floating-cart-button-bottom:hover {
      transform: translateY(-5px) scale(1.1);
      box-shadow: 0 15px 35px var(--shadow-dark);
      color: white;
      animation: bounce 0.6s ease-in-out;
    }

    .floating-cart-button-bottom i {
      font-size: 28px;
    }

    .cart-count-badge-bottom {
      position: absolute;
      top: -8px;
      right: -8px;
      background: #ff0000;
      color: white;
      border-radius: 50%;
      width: 25px;
      height: 25px;
      display: none;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      font-weight: bold;
      border: 2px solid white;
      animation: pulse 2s infinite;
    }

    @keyframes bounce {

      0%,
      20%,
      50%,
      80%,
      100% {
        transform: translateY(-5px) scale(1.1);
      }

      40% {
        transform: translateY(-10px) scale(1.15);
      }

      60% {
        transform: translateY(-7px) scale(1.12);
      }
    }

    @keyframes pulse {
      0% {
        transform: scale(1);
      }

      50% {
        transform: scale(1.2);
      }

      100% {
        transform: scale(1);
      }
    }

    /* Animation d'apparition */
    .floating-cart-button-bottom {
      animation: slideUp 0.5s ease-out;
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(100px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Responsive */
    @media (max-width: 768px) {
      .floating-cart-button-bottom {
        width: 60px;
        height: 60px;
        bottom: 20px;
        right: 20px;
      }

      .floating-cart-button-bottom i {
        font-size: 24px;
      }

      .cart-count-badge-bottom {
        width: 22px;
        height: 22px;
        font-size: 12px;
      }
    }

    /* Checkout button enhancement */
    #checkout-btn {
      background: linear-gradient(135deg, var(--accent-color), var(--accent-hover));
      border: none;
      border-radius: 25px;
      padding: 15px;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    #checkout-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(255, 107, 53, 0.4);
    }
  </style>
</head>

<body class="sub_page">


  <div class="hero_area">

    <div class="bg-box">

      <img src="images/hero-bg.jpg" alt="">
    </div>
    <!-- header section strats -->
    <div
      style="background: linear-gradient(135deg, var(--accent-color), var(--accent-hover), #ff8a65); color: white; text-align: center; padding: 15px 0; font-weight: 700; font-size: 24px; position: relative; overflow: hidden; box-shadow: 0 6px 20px rgba(255, 107, 53, 0.4); border-bottom: 3px solid rgba(255,255,255,0.2);">
      <!-- Animated background -->
      <div
        style="position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent); animation: shine 3s infinite;">
      </div>

      <!-- Floating particles -->
      <div
        style="position: absolute; width: 6px; height: 6px; background: rgba(255,255,255,0.6); border-radius: 50%; top: 20%; left: 10%; animation: float 4s ease-in-out infinite;">
      </div>
      <div
        style="position: absolute; width: 4px; height: 4px; background: rgba(255,255,255,0.4); border-radius: 50%; top: 60%; left: 80%; animation: float 3s ease-in-out infinite 1s;">
      </div>
      <div
        style="position: absolute; width: 8px; height: 8px; background: rgba(255,255,255,0.3); border-radius: 50%; top: 40%; left: 90%; animation: float 5s ease-in-out infinite 2s;">
      </div>

      <div
        style="display: flex; align-items: center; justify-content: center; gap: 20px; flex-wrap: wrap; position: relative; z-index: 2;">
        <!-- Main delivery message with enhanced styling -->
        <div
          style="background: rgba(255,255,255,0.15); padding: 12px 20px; border-radius: 25px; backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2); box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
          <span
            style="font-size: 25px; font-family: 'Arial', sans-serif; text-shadow: 2px 2px 6px rgba(0,0,0,0.4); letter-spacing: 0.5px; animation: glow 2s ease-in-out infinite alternate;">Livraison
            gratuite à partir de 15€ ! Ostricourt • Evin-Malmaison • Leforest • Thumeries • Oignies • Wahagnies</span>
          <br>
          <span
            style="font-size: 14px; font-weight: 400; opacity: 0.9; text-shadow: 1px 1px 3px rgba(0,0,0,0.3);"></span>
        </div>
      </div>
    </div>

    <style>
      @keyframes shine {
        0% {
          left: -100%;
        }

        100% {
          left: 100%;
        }
      }

      @keyframes glow {
        0% {
          text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.4), 0 0 10px rgba(255, 255, 255, 0.3);
        }

        100% {
          text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.4), 0 0 20px rgba(255, 255, 255, 0.6);
        }
      }

      @keyframes float {

        0%,
        100% {
          transform: translateY(0px) rotate(0deg);
          opacity: 1;
        }

        50% {
          transform: translateY(-20px) rotate(180deg);
          opacity: 0.7;
        }
      }

      @media (max-width: 768px) {
        .delivery-banner {
          font-size: 18px !important;
          padding: 20px 10px !important;
        }

        .delivery-banner .main-message {
          font-size: 18px !important;
          padding: 10px 15px !important;
        }
      }

      @media (max-width: 480px) {
        .delivery-banner {
          font-size: 16px !important;
          padding: 18px 8px !important;
        }

        .delivery-banner .main-message {
          font-size: 16px !important;
          padding: 8px 12px !important;
        }
      }
    </style>
    <header class="header_section">

      <div class="container">
        <nav class="navbar navbar-expand-lg custom_nav-container ">


          <a class="navbar-brand" href="index.html">
            <span>
              Speranza Pizza
            </span>
          </a>

          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class=""> </span>
          </button>

          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav  mx-auto ">
              <li class="nav-item">
                <a class="nav-link" href="index.html">Acceuil </a>
              </li>
              <li class="nav-item active">
                <a class="nav-link" href="menu.html">Menu <span class="sr-only">(current)</span> </a>
              </li>
              <!-- <li class="nav-item">
                <a class="nav-link" href="about.html">About</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="book.html">Book Table</a>
              </li> -->
            </ul>
            <div class="user_option">
              <a class="cart_link" href="#" onclick="toggleCart()">
                <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 456.029 456.029"
                  style="enable-background:new 0 0 456.029 456.029;" xml:space="preserve">
                  <g>
                    <g>
                      <path d="M345.6,338.862c-29.184,0-53.248,23.552-53.248,53.248c0,29.184,23.552,53.248,53.248,53.248
                           c29.184,0,53.248-23.552,53.248-53.248C398.336,362.926,374.784,338.862,345.6,338.862z" />
                    </g>
                  </g>
                  <g>
                    <g>
                      <path d="M439.296,84.91c-1.024,0-2.56-0.512-4.096-0.512H112.64l-5.12-34.304C104.448,27.566,84.992,10.67,61.952,10.67H20.48
                           C9.216,10.67,0,19.886,0,31.15c0,11.264,9.216,20.48,20.48,20.48h41.472c2.56,0,4.608,2.048,5.12,4.608l31.744,216.064
                           c4.096,27.136,27.648,47.616,55.296,47.616h212.992c26.624,0,49.664-18.944,55.296-45.056l33.28-166.4
                           C457.728,97.71,450.56,86.958,439.296,84.91z" />
                    </g>
                  </g>
                  <g>
                    <g>
                      <path
                        d="M215.04,389.55c-1.024-28.16-24.576-50.688-52.736-50.688c-29.696,1.536-52.224,26.112-51.2,55.296
                           c1.024,28.16,24.064,50.688,52.224,50.688h1.024C193.536,443.31,216.576,418.734,215.04,389.55z" />
                    </g>
                  </g>
                </svg>
                <span id="cart-count" class="cart-count" style="display: none;">0</span>
              </a>
              <!-- <a href="menu.html" class="order_online">
                <i class="fa fa-cutlery"></i>
                <span class="order-text">Commandez maintenant</span>
              </a> -->
            </div>

            <style>
              /* Enhanced User Options Styling */
              .user_option {
                display: flex;
                align-items: center;
                gap: 15px;
              }

              /* Enhanced Cart Link */
              .cart_link {
                position: relative;
                display: flex;
                align-items: center;
                justify-content: center;
                width: 55px;
                height: 55px;
                background: linear-gradient(135deg, var(--accent-color), var(--accent-hover));
                border-radius: 50%;
                transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
                box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
                border: 2px solid rgba(255, 255, 255, 0.1);
              }

              .cart_link:hover {
                transform: translateY(-3px) scale(1.05);
                box-shadow: 0 8px 25px rgba(255, 107, 53, 0.4);
                border-color: rgba(255, 255, 255, 0.3);
              }

              .cart_link svg {
                width: 24px;
                height: 24px;
                fill: white;
                transition: all 0.3s ease;
              }

              .cart_link:hover svg {
                transform: scale(1.1);
              }

              /* Enhanced Cart Count Badge */
              .cart-count {
                position: absolute;
                top: -8px;
                right: -8px;
                background: linear-gradient(135deg, #dc3545, #c82333);
                color: white;
                border-radius: 50%;
                width: 24px;
                height: 24px;
                font-size: 12px;
                font-weight: bold;
                display: flex;
                align-items: center;
                justify-content: center;
                border: 2px solid white;
                box-shadow: 0 2px 8px rgba(220, 53, 69, 0.4);
                animation: pulse 2s infinite;
              }

              @keyframes pulse {
                0% {
                  transform: scale(1);
                }

                50% {
                  transform: scale(1.1);
                }

                100% {
                  transform: scale(1);
                }
              }

              /* Enhanced Order Button */
              .order_online {
                display: flex;
                align-items: center;
                gap: 10px;
                background: linear-gradient(135deg, var(--accent-color), var(--accent-hover));
                color: white !important;
                padding: 15px 25px;
                border-radius: 30px;
                text-decoration: none;
                font-weight: 600;
                font-size: 16px;
                transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
                box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
                border: 2px solid transparent;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                position: relative;
                overflow: hidden;
              }

              .order_online::before {
                content: '';
                position: absolute;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100%;
                background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
                transition: left 0.5s ease;
              }

              .order_online:hover::before {
                left: 100%;
              }

              .order_online:hover {
                transform: translateY(-3px);
                box-shadow: 0 8px 25px rgba(255, 107, 53, 0.4);
                border-color: rgba(255, 255, 255, 0.3);
                color: white !important;
                text-decoration: none;
              }

              .order_online i {
                font-size: 18px;
                transition: transform 0.3s ease;
              }

              .order_online:hover i {
                transform: rotate(15deg) scale(1.1);
              }

              /* Mobile Responsive Design */
              @media (max-width: 991px) {
                .user_option {
                  gap: 12px;
                  margin-top: 15px;
                  justify-content: center;
                  flex-wrap: wrap;
                }

                .cart_link {
                  width: 50px;
                  height: 50px;
                }

                .cart_link svg {
                  width: 22px;
                  height: 22px;
                }

                .order_online {
                  padding: 12px 20px;
                  font-size: 15px;
                  border-radius: 25px;
                }

                .order_online i {
                  font-size: 16px;
                }
              }

              @media (max-width: 768px) {
                .user_option {
                  width: 100%;
                  padding: 15px 0;
                  border-top: 1px solid rgba(255, 255, 255, 0.1);
                  margin-top: 20px;
                  justify-content: space-between;
                }

                .cart_link {
                  width: 48px;
                  height: 48px;
                  flex-shrink: 0;
                }

                .cart_link svg {
                  width: 20px;
                  height: 20px;
                }

                .cart-count {
                  width: 22px;
                  height: 22px;
                  font-size: 11px;
                  top: -6px;
                  right: -6px;
                }

                .order_online {
                  flex: 1;
                  margin-left: 15px;
                  padding: 14px 20px;
                  font-size: 14px;
                  justify-content: center;
                  max-width: 250px;
                }

                .order-text {
                  display: block;
                }
              }

              @media (max-width: 480px) {
                .user_option {
                  flex-direction: column;
                  gap: 15px;
                  align-items: stretch;
                }

                .cart_link {
                  align-self: center;
                  width: 45px;
                  height: 45px;
                }

                .order_online {
                  width: 100%;
                  max-width: none;
                  margin-left: 0;
                  padding: 16px 24px;
                  font-size: 16px;
                  font-weight: 700;
                }
              }

              /* Extra small devices */
              @media (max-width: 360px) {
                .order_online {
                  padding: 14px 20px;
                  font-size: 14px;
                }

                .order-text {
                  font-size: 14px;
                }
              }

              /* Navigation responsive adjustments */
              @media (max-width: 991px) {
                .navbar-collapse {
                  text-align: center;
                  padding-top: 20px;
                }

                .navbar-nav {
                  margin-bottom: 20px;
                }

                .nav-item {
                  margin: 5px 0;
                }
              }

              /* Enhanced hover effects for touch devices */
              @media (hover: none) and (pointer: coarse) {
                .cart_link:active {
                  transform: scale(0.95);
                }

                .order_online:active {
                  transform: scale(0.98);
                }
              }
            </style>
          </div>
        </nav>
      </div>
    </header>
    <!-- end header section -->
  </div>

  <!-- Floating Cart -->
  <div id="floating-cart" class="floating-cart">
    <div class="cart-toggle" onclick="toggleCart()"
      style="left: -60px; top: 20px; padding: 18px; width: 60px; height: 60px; display: flex; align-items: center; justify-content: center;">
      <i class="fa fa-shopping-cart" style="font-size: 40px;"></i>
      <span id="cart-toggle-count" class="cart-count" style="display: none;">0</span>
    </div>

    <div class="cart-header">
      <div class="d-flex justify-content-between align-items-center">
        <h5 class="mb-0">Votre panier</h5>
        <div class="d-flex align-items-center" style="gap: 8px;">
          <button class="btn btn-sm" onclick="clearCart()"
            style="background: rgba(255,0,0,0.3); color: white; border: none; border-radius: 15px; padding: 5px 10px; font-size: 12px;"
            title="Vider le panier">
            <i class="fa fa-trash"></i> Vider
          </button>
          <button class="btn btn-sm" onclick="toggleCart()"
            style="background: rgba(255,255,255,0.2); color: white; border: none; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center;">
            <i class="fa fa-times"></i>
          </button>
        </div>
      </div>
    </div>

    <div id="cart-items">
      <div id="empty-cart" class="text-center p-3">
        <p>Votre panier est vide</p>
      </div>
    </div>

    <div class="cart-footer">
      <div class="cart-total">
        Total: €<span id="cart-total">0</span>
      </div>
      <button class="btn btn-primary btn-block" onclick="checkOpenAndCheckout()" id="checkout-btn"
        style="display: none;">
        Passer à la caisse
      </button>
      <script>
        function isOpenNow(d = new Date()) {
          const day = d.getDay(); // 0=Dim,1=Lun,...,5=Ven,6=Sam
          const minutes = d.getHours() * 60 + d.getMinutes();
          const inRange = (start, end) => minutes >= start && minutes < end;

          const LUNCH_START = 11 * 60, LUNCH_END = 14 * 60;
          const DINNER_START = 18 * 60, DINNER_END = 23 * 60;

          if (day === 5) { // Vendredi
            return inRange(DINNER_START, DINNER_END);
          }
          // Lundi-Jeudi (1-4) et Samedi (6) et Dimanche (0)
          if (day === 0 || (day >= 1 && day <= 4) || day === 6) {
            return inRange(LUNCH_START, LUNCH_END) || inRange(DINNER_START, DINNER_END);
          }
          return false;
        }

        function checkOpenAndCheckout() {
          if (isOpenNow()) {
            proceedToCheckout();
          } else {
            alert(
              "Désolé, nous sommes actuellement fermés.\n\n" +
              "Horaires d'ouverture :\n" +
              "Lundi - Jeudi, Samedi - Dimanche :\n" +
              "11h00 - 14h00 et 18h00 - 23h00\n\n" +
              "Vendredi :\n" +
              "18h00 - 23h00" +
              "\n\nVotre commande est enregistrée, Veuillez revenir pendant nos heures d'ouverture pour passer votre commande."
            );
          }
        }
      </script>
    </div>
  </div>

  <script>
    // Ensure leftover .cart-item nodes are removed when the cart becomes empty.
    (function () {
      const cartItemsContainer = document.getElementById('cart-items');
      const emptyCartEl = document.getElementById('empty-cart');

      if (!cartItemsContainer || !emptyCartEl) return;

      // Helper to remove any stale .cart-item children
      function removeStaleItems() {
        const items = cartItemsContainer.querySelectorAll('.cart-item');
        items.forEach(i => i.remove());
        // keep cart-total in sync
        const cartTotal = document.getElementById('cart-total');
        if (cartTotal) cartTotal.textContent = '0';
        const cartCount = document.getElementById('cart-count');
        const cartToggleCount = document.getElementById('cart-toggle-count');
        if (cartCount) cartCount.style.display = 'none';
        if (cartToggleCount) cartToggleCount.style.display = 'none';
      }

      // Observe style attribute changes on the empty cart node (updateCartDisplay toggles style.display)
      const obs = new MutationObserver(() => {
        try {
          const isVisible = emptyCartEl.style.display !== 'none' && getComputedStyle(emptyCartEl).display !== 'none';
          if (isVisible) removeStaleItems();
        } catch (e) { /* ignore */ }
      });

      obs.observe(emptyCartEl, { attributes: true, attributeFilter: ['style'] });

      // Also run once on load in case updateCartDisplay returned early previously
      document.addEventListener('DOMContentLoaded', () => {
        const isVisibleNow = emptyCartEl.style.display !== 'none' && getComputedStyle(emptyCartEl).display !== 'none';
        if (isVisibleNow) removeStaleItems();
      });
    })();
  </script>

  <!-- food section -->
  <section class="food_section layout_padding">
    <div class="container">
      <div class="heading_container heading_center">
        <h2>Notre Menu</h2>
      </div>

      <!-- <ul class="filters_menu">
        <li class="active" data-filter="*">All</li>
        <li data-filter=".burger">Burger</li>
        <li data-filter=".pizza">Pizza</li>
        <li data-filter=".pasta">Pasta</li>
        <li data-filter=".fries">Fries</li>
      </ul> -->
      <ul class="filters_menu">
        <li class="active" data-filter="*">All</li>
        <li data-filter=".pizza">Pizza</li>
        <li data-filter=".burger">Burger</li>
        <li data-filter=".pasta">Pâtes</li>
        <li data-filter=".tacos">Tacos</li>
        <li data-filter=".taco_bowl">Taco Bowls</li>
        <li data-filter=".panini">Panini</li>
        <li data-filter=".tex-mex">Tex-Mex</li>
        <li data-filter=".salade">Salades</li>
        <li data-filter=".fries">Frites</li>
        <li data-filter=".dessert">Desserts</li>
        <li data-filter=".boissons">Boissons</li>
        <li data-filter=".menuenfant">Menu Enfant</li>
        <li data-filter=".assiettes">Assiettes </li>

        <li data-filter=".crousty">Crousty</li>

        <li data-filter=".Sandwichs">Sandwichs (Boisson incluse)</li>
        <li data-filter=".menu_junior">Menu Junior (Boisson incluse)</li>
        <li data-filter=".menu_duo">Menu Duo (Boisson incluse)</li>
        <li data-filter=".menu_mega">Menu Méga (Boisson incluse)</li>
      </ul>
      <div class="filters-content">
        <div class="row product-grid" id="product-grid">
          <!-- Les produits seront chargés dynamiquement ici -->
        </div>
      </div>
      <div class="btn-box"><a href="">Voir plus</a></div>
    </div>
    <div class="modal fade" id="canetteModal" tabindex="-1" role="dialog" aria-labelledby="canetteModalLabel"
      aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content"
          style="background: var(--card-bg); color: var(--text-primary); border: 1px solid var(--border-color);">
          <div class="modal-header" style="border-bottom: 1px solid var(--border-color);">
            <h5 class="modal-title" id="canetteModalLabel" style="color: var(--text-primary);">Choisissez votre boisson
            </h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"
              style="color: var(--text-primary); opacity: 0.8;">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body" style="background: var(--card-bg);">
            <div class="row" id="canette-options">
              <!-- Les options de canettes seront chargées ici -->
            </div>
          </div>
          <div class="modal-footer" style="border-top: 1px solid var(--border-color); background: var(--card-bg);">
            <button type="button" class="btn btn-secondary" data-dismiss="modal"
              style="background: var(--border-color); color: var(--text-primary); border: 1px solid var(--border-color);">Annuler</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Menu Drink Selection Modal -->
    <div class="modal fade" id="menuDrinkModal" tabindex="-1" role="dialog" aria-labelledby="menuDrinkModalLabel"
      aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content"
          style="background: var(--card-bg); color: var(--text-primary); border: 1px solid var(--border-color);">
          <div class="modal-header" style="border-bottom: 1px solid var(--border-color);">
            <h5 class="modal-title" id="menuDrinkModalLabel" style="color: var(--text-primary);">Choisissez votre
              boisson</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"
              style="color: var(--text-primary); opacity: 0.8;">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body" style="background: var(--card-bg);">
            <div class="row" id="menu-drink-options">
              <!-- Les options de boisson seront chargées ici -->
            </div>
          </div>
          <div class="modal-footer" style="border-top: 1px solid var(--border-color); background: var(--card-bg);">
            <button type="button" class="btn btn-secondary" data-dismiss="modal"
              style="background: var(--border-color); color: var(--text-primary); border: 1px solid var(--border-color);">Annuler</button>
          </div>
        </div>
      </div>
    </div>

    <script>
      (function () {
        // Apply given filter to the currently rendered product cards
        function applyFilter(filterValue) {
          const productCards = document.querySelectorAll('.product-grid > div');
          productCards.forEach(card => {
            if (filterValue === '*' || card.classList.contains(filterValue.substring(1))) {
              card.style.display = 'block';
            } else {
              card.style.display = 'none';
            }
          });
        }

        // Delegate clicks on filter buttons so we always use the current product list
        document.addEventListener('click', function (e) {
          const li = e.target.closest('.filters_menu li');
          if (!li) return;
          const filterButtons = document.querySelectorAll('.filters_menu li');
          filterButtons.forEach(btn => btn.classList.remove('active'));
          li.classList.add('active');
          const filterValue = li.getAttribute('data-filter');
          applyFilter(filterValue);
        });

        // When products are inserted into the grid, apply the currently active filter once
        const grid = document.getElementById('product-grid');
        if (grid) {
          const observer = new MutationObserver(function (mutations, obs) {
            if (grid.children.length > 0) {
              const active = document.querySelector('.filters_menu li.active');
              if (active) applyFilter(active.getAttribute('data-filter'));
              obs.disconnect();
            }
          });
          observer.observe(grid, { childList: true });
        }
      })();
    </script>
  </section>

  <!-- Rest of the HTML remains the same... -->
  <!-- Checkout Modal -->
  <div class="modal fade" id="checkoutModal" tabindex="-1" role="dialog" aria-labelledby="checkoutModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
      <div class="modal-content"
        style="background: var(--card-bg); color: var(--text-primary); border: 1px solid var(--border-color);">
        <div class="modal-header" style="border-bottom: 1px solid var(--border-color);">
          <h5 class="modal-title" id="checkoutModalLabel" style="color: var(--text-primary);">Finalisez votre commande
          </h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"
            style="color: var(--text-primary); opacity: 0.8;">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body" style="background: var(--card-bg);">
          <div class="row">
            <div class="col-md-6">
              <h6 style="color: var(--accent-color);">Résumé de la commande</h6>
              <div id="checkout-items" style="color: var(--text-primary);"></div>
              <hr style="border-color: var(--border-color);">
              <div class="d-flex justify-content-between">
                <strong style="color: var(--accent-color);">Total: €<span id="checkout-total">0</span></strong>
              </div>
              <div class="alert alert-warning w-100 text-center shadow-sm" style="background: linear-gradient(135deg, #fff8e1, #fff3cd); 
            color: #856404; 
            border: 1px solid #ffeeba; 
            border-radius: 12px; 
            font-weight: 600; 
            padding: 15px 20px;
            margin-bottom: 0; 
            font-size: 1rem; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            gap: 10px;">
                <i class="bi bi-truck" style="font-size: 1.3rem; color: #ff9800;"></i>
                <span>Remarque : Si la commande est supérieure à <b>15 €</b>, la livraison est <b>gratuite</b>, sinon
                  <b>3 €</b>.</span>
              </div>


            </div>
            <div class="col-md-6">
              <h6 style="color: var(--accent-color);">Informations Client</h6>
              <form id="checkoutForm">
                <div class="form-group">
                  <label for="customerName" style="color: var(--text-primary);">Nom Complet:</label>
                  <input type="text" id="customerName" class="form-control" required
                    style="background: var(--darker-bg); color: var(--text-primary); border: 1px solid var(--border-color);">
                </div>
                <div class="form-group">
                  <label for="customerEmail" style="color: var(--text-primary);">Email:</label>
                  <input type="email" id="customerEmail" class="form-control" required
                    style="background: var(--darker-bg); color: var(--text-primary); border: 1px solid var(--border-color);">
                </div>
                <div class="form-group">
                  <label for="customerPhone" style="color: var(--text-primary);">Téléphone:</label>
                  <input type="tel" id="customerPhone" class="form-control" required
                    style="background: var(--darker-bg); color: var(--text-primary); border: 1px solid var(--border-color);">
                </div>
                <div class="form-group">
                  <label for="customerLocation" style="color: var(--text-primary);">Adresse de Livraison:</label>
                  <textarea id="customerLocation" class="form-control" rows="3" required
                    style="background: var(--darker-bg); color: var(--text-primary); border: 1px solid var(--border-color);"
                    placeholder="Votre adresse sera remplie automatiquement si vous autorisez l'accès à la localisation"></textarea>
                  <button type="button" class="btn btn-info mt-2" onclick="detectLocation()"
                    style="background: var(--accent-color); color: white; border: none;">
                    Détecter ma position (GPS)
                  </button>
                  <small id="locationStatus"
                    style="color: var(--accent-color); display: block; margin-top: 5px;"></small>
                </div>
                <script>
                  function detectLocation() {
                    const status = document.getElementById('locationStatus');
                    status.textContent = "Detecting location...";
                    if (!navigator.geolocation) {
                      status.textContent = "Geolocation is not supported by your browser.";
                      return;
                    }
                    navigator.geolocation.getCurrentPosition(
                      async function (position) {
                        const lat = position.coords.latitude;
                        const lng = position.coords.longitude;

                        try {
                          // Google Maps link
                          const mapsLink = `https://www.google.com/maps?q=${lat},${lng}`;

                          // Optionnel: récupérer l’adresse (reverse geocoding)
                          const url = `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}`;
                          const res = await fetch(url);
                          const data = await res.json();
                          let address = data?.display_name || '';

                          // Affiche dans le textarea
                          document.getElementById('customerLocation').value = address + "\n" + mapsLink;

                          // Lien cliquable
                          status.innerHTML = `✅ Localisation détectée ! 
          <a href="${mapsLink}" target="_blank" 
             style="color:var(--accent-color);text-decoration:underline;">
             Ouvrir dans Google Maps
          </a>`;

                        } catch (e) {
                          status.textContent = "Error detecting address. Please enter manually.";
                        }
                      },
                      function (error) {
                        if (error.code === error.PERMISSION_DENIED) {
                          status.textContent = "Location access denied. Please allow location access in your browser settings.";
                        } else if (error.code === error.POSITION_UNAVAILABLE) {
                          status.textContent = "Location information is unavailable.";
                        } else if (error.code === error.TIMEOUT) {
                          status.textContent = "Location request timed out. Try again.";
                        } else {
                          status.textContent = "Location access denied or unavailable.";
                        }
                      },
                      { enableHighAccuracy: true, timeout: 15000, maximumAge: 0 }
                    );
                  }
                </script>
              </form>
            </div>
          </div>
        </div>
        <div class="modal-footer" style="border-top: 1px solid var(--border-color); background: var(--card-bg);">
          <button type="button" class="btn btn-secondary" data-dismiss="modal"
            style="background: var(--border-color); color: var(--text-primary); border: 1px solid var(--border-color);">Annuler</button>
          <button type="button" class="btn btn-primary" onclick="submitOrder()"
            style="background: linear-gradient(135deg, var(--accent-color), var(--accent-hover)); border: none;">Suivant</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Firebase Scripts -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

  <script>
    // --- Firebase Initialization ---
    let db;
    ensureFirebase().then(() => {
      console.log('Firebase initialized');
      loadProducts();
    }).catch(err => {
      console.error('Error initializing Firebase:', err);
      // Fallback to static products if Firebase fails
      loadProducts();
    });
    async function ensureFirebase() {
      if (db) return db;
      if (!window.firebase || !window.firebase.firestore) {
        await new Promise(res => setTimeout(res, 200));
        if (!window.firebase || !window.firebase.firestore) throw new Error('Firebase SDK not loaded');
      }
      if (!db) {
        // Use server-side Node.js API to get config
        const res = await fetch('/api/config');
        const config = await res.json();
        if (!firebase.apps.length) firebase.initializeApp(config);
        db = firebase.firestore();
      }
      return db;
    }

    // Filter functionality
    document.addEventListener('DOMContentLoaded', function () {
      const filterButtons = document.querySelectorAll('.filters_menu li');
      const productCards = document.querySelectorAll('.product-grid > div');

      filterButtons.forEach(button => {
        button.addEventListener('click', function () {
          // Remove active class from all buttons
          filterButtons.forEach(btn => btn.classList.remove('active'));
          // Add active class to clicked button
          this.classList.add('active');

          const filterValue = this.getAttribute('data-filter');

          productCards.forEach(card => {
            if (filterValue === '*' || card.classList.contains(filterValue.substring(1))) {
              card.style.display = 'block';
            } else {
              card.style.display = 'none';
            }
          });
        });
      });
    });

    // Static product data to avoid CORS issues
    const drinkOptions = [
      { name: "Coca Cola", price: 0 },
      { name: "Coca Cola Zero", price: 0 },
      { name: "Coca Cola Cherry", price: 0 },
      { name: "Ice Tea Pêche", price: 0 },
      { name: "Perrier", price: 0 },
      { name: "Sprite", price: 0 },
      { name: "7up", price: 0 },
      { name: "Orangina", price: 0 },
      { name: "Oasis Tropical", price: 0 },
      { name: "Oasis Framboise", price: 0 },
      { name: "Fanta Orange", price: 0 },
      { name: "Fanta Citron", price: 0 },
      { name: "Tropico", price: 0 },
      { name: "Hawaï", price: 0 },
      { name: "7up Cherry", price: 0 },
      { name: "Schweppes Agrumes", price: 0 },
      { name: "Mojito (sans alcool)", price: 0 }
    ];

    // Static product data to avoid CORS issues
    const products = [

      // // --- BURGERS ---
      // Classiques
      { name: "Cheese Burger", price: 6.5, description: "Classique gourmet au steak juteux et cheddar fondant.", category: "burger", image: "images/b1.jpg", ingredients: ["Steak 90g", "Cheddar", "Salade", "Tomate", "Sauce au choix"] },
      { name: "Cheese Burger (Menu)", price: 8, description: "Version menu du classique avec accompagnement complet.", category: "burger", image: "images/b1.jpg", ingredients: ["Steak 90g", "Cheddar", "Salade", "Tomate", "Sauce au choix"] },
      { name: "Fish Burger", price: 6.5, description: "Filet de poisson croustillant et cheddar pour une bouchée légère.", category: "burger", image: "images/b2.jpg", ingredients: ["Poisson", "Cheddar", "Salade", "Tomate", "Sauce au choix"] },
      { name: "Fish Burger (Menu)", price: 8, description: "Fish burger servi avec frites et boisson pour un repas équilibré.", category: "burger", image: "images/b2.jpg", ingredients: ["Poisson", "Cheddar", "Salade", "Tomate", "Sauce au choix"] },
      { name: "Chicken Burger", price: 6.5, description: "Poulet tendre, galette dorée et cheddar dans un pain moelleux.", category: "burger", image: "images/b3.jpg", ingredients: ["Chicken", "Galette", "Cheddar", "Salade", "Tomate", "Sauce au choix"] },
      { name: "Chicken Burger (Menu)", price: 8, description: "Chicken burger accompagné de frites et boisson.", category: "burger", image: "images/b3.jpg", ingredients: ["Chicken", "Galette", "Cheddar", "Salade", "Tomate", "Sauce au choix"] },

      // XXL
      { name: "Bio Bacon Burger", price: 9, description: "Steak épais, double cheddar et bacon fumé pour une intensité généreuse.", category: "burger", image: "images/b4.jpg", ingredients: ["Steak 180g", "Double Cheddar", "Bacon", "Salade", "Tomate", "Sauce au choix"] },
      { name: "Bio Bacon Burger (Menu)", price: 10.5, description: "La version menu du burger bacon avec garnitures complètes.", category: "burger", image: "images/b4.jpg", ingredients: ["Steak 180g", "Double Cheddar", "Bacon", "Salade", "Tomate", "Sauce au choix"] },
      { name: "Le King Burger", price: 9, description: "Steak épais, œuf coulant et cheddar pour une expérience royale.", category: "burger", image: "images/b5.jpg", ingredients: ["Steak 180g", "Cheddar", "Œuf", "Salade", "Tomate", "Sauce au choix"] },
      { name: "Le King Burger (Menu)", price: 10.5, description: "Le King en formule avec frites et boisson.", category: "burger", image: "images/b5.jpg", ingredients: ["Steak 180g", "Cheddar", "Œuf", "Salade", "Tomate", "Sauce au choix"] },
      { name: "Ostri Burger", price: 10, description: "Double steak, bacon et double cheddar pour appétits XXL.", category: "burger", image: "images/b6.jpg", ingredients: ["2 Steaks 180g", "Bacon", "2 Cheddar", "Œuf", "Salade", "Tomate", "Sauce au choix"] },
      { name: "Ostri Burger (Menu)", price: 11.5, description: "Version menu ultra gourmande du Ostri.", category: "burger", image: "images/b6.jpg", ingredients: ["2 Steaks 180g", "Bacon", "2 Cheddar", "Œuf", "Salade", "Tomate", "Sauce au choix"] },

      // Speciaux
      { name: "Bacon Burger", price: 7.5, description: "Steak, bacon fumé, œuf et cheddar pour une richesse savoureuse.", category: "burger", image: "images/b7.jpg", ingredients: ["Steak 90g", "Bacon Cheddar", "Œuf", "Salade", "Tomate", "Sauce au choix"] },
      { name: "Bacon Burger (Menu)", price: 9, description: "Bacon burger servi avec frites et boisson.", category: "burger", image: "images/b7.jpg", ingredients: ["Steak 90g", "Bacon Cheddar", "Œuf", "Salade", "Tomate", "Sauce au choix"] },

      { name: "Speranza Burger", price: 7.5, description: "Signature maison associant bœuf, poulet et croustillant gourmand.", category: "burger", image: "images/b8.jpg", ingredients: ["Steak 90g", "Chicken", "Galette P.Terre", "Cheddars", "Salade", "Tomate", "Sauce au choix"] },
      { name: "Speranza Burger (Menu)", price: 9, description: "Notre création maison en version menu complète.", category: "burger", image: "images/b8.jpg", ingredients: ["Steak 90g", "Chicken", "Galette P.Terre", "Cheddars", "Salade", "Tomate", "Sauce au choix"] },

      { name: "Burger Raclette", price: 7.5, description: "Fromage raclette fondant et texture rustique réconfortante.", category: "burger", image: "images/raclette burguer.jpg", ingredients: ["Steak 90g", "Raclette", "Galette P.Terre", "Cheddars", "Salade", "Tomate", "Sauce au choix"] },
      { name: "Burger Raclette (Menu)", price: 9, description: "Burger montagnard servi avec ses accompagnements.", category: "burger", image: "images/raclette burguer.jpg", ingredients: ["Steak 90g", "Raclette", "Galette P.Terre", "Cheddars", "Salade", "Tomate", "Sauce au choix"] },

      { name: "Burger CHTI", price: 7.5, description: "Maroilles puissant et double steak pour un goût du Nord affirmé.", category: "burger", image: "images/chti burguer.jpg", ingredients: ["2 Steaks 90g", "Maroilles", "Cheddar", "Salade", "Tomate", "Sauce au choix"] },
      { name: "Burger CHTI (Menu)", price: 9, description: "Recette au maroilles servie avec frites et boisson.", category: "burger", image: "images/chti burguer.jpg", ingredients: ["2 Steaks 90g", "Maroilles", "Cheddar", "Salade", "Tomate", "Sauce au choix"] },

      { name: "Burger BIGGY", price: 7.5, description: "Double steak généreux et cheddar fondant pour les grands gourmands.", category: "burger", image: "images/bigy burguer.jpg", ingredients: ["2 Steak 90g", "Cheddar", "Salade", "Tomate", "Sauce au choix"] },
      { name: "Burger BIGGY (Menu)", price: 9, description: "BIGGY complet avec garnitures classiques.", category: "burger", image: "images/bigy burguer.jpg", ingredients: ["2 Steak 90g", "Cheddar", "Salade", "Tomate", "Sauce au choix"] },

      { name: "Burger SPICY", price: 7.5, description: "Chorizo et poivrons pour une note relevée équilibrée.", category: "burger", image: "images/spicy burguer.jpg", ingredients: ["Steak 90g", "Chorizo", "Cheddar", "Poivrons", "Salade", "Tomate", "Sauce au choix"] },
      { name: "Burger SPICY (Menu)", price: 9, description: "Version menu épicée avec accompagnements.", category: "burger", image: "images/spicy burguer.jpg", ingredients: ["Steak 90g", "Chorizo", "Cheddar", "Poivrons", "Salade", "Tomate", "Sauce au choix"] },

      { name: "Burger TENDERS", price: 7.5, description: "Poulet croustillant et cheddar dans une composition moelleuse.", category: "burger", image: "images/Burger TENDERS.jpg", ingredients: ["Tenders Cheddar", "Salade", "Tomate", "Sauce au choix"] },
      { name: "Burger TENDERS (Menu)", price: 9, description: "Burger tenders servi avec frites et boisson.", category: "burger", image: "images/Burger TENDERS.jpg", ingredients: ["Tenders Cheddar", "Salade", "Tomate", "Sauce au choix"] },

      // --- PATES (PASTA) ---
      { name: "Pâtes Carbonara", price: 9, description: "Recette romaine traditionnelle crémeuse et savoureuse", category: "pasta", image: "images/p1.jpg", ingredients: ["Pâtes", "Crème Fraîche", "Lardons", "Œuf", "Parmesan"] },
      { name: "Pâtes Saumon", price: 9, description: "Délicatesse nordique pour un plat raffiné", category: "pasta", image: "images/p2.jpg", ingredients: ["Pâtes", "Crème Fraîche", "Saumon", "Parmesan"] },
      { name: "Pâtes Bolognaise", price: 9, description: "L'authentique recette milanaise intemporelle", category: "pasta", image: "images/p3.jpg", ingredients: ["Pâtes", "Sauce Tomate", "Viande Hachée", "Parmesan"] },
      { name: "Pâtes Fruits de Mer", price: 9, description: "Voyage maritime dans votre assiette", category: "pasta", image: "images/p4.jpg", ingredients: ["Pâtes", "Sauce Tomate", "Fruits de mer", "Parmesan"] },
      { name: "Pâtes Al Tartuffo", price: 9, description: "Expérience gastronomique aux arômes nobles", category: "pasta", image: "images/p5.jpg", ingredients: ["Pâtes", "Crème Fraîche", "Crème de Truffe", "Poulet", "Champignons", "Parmesan"] },

      // --- TEX MEX & FRIES ---
      { name: "6 Nuggets", price: 6, description: "Bouchées dorées et croustillantes pour petites faims", category: "tex-mex", image: "images/n1.jpg", ingredients: ["Nuggets de poulet (6 pièces)"] },
      { name: "Menu 6 Nuggets", price: 8, description: "Formule complète avec accompagnements pour enfants", category: "tex-mex", image: "images/n2.png", hasDrink: true, drinkOptions: drinkOptions, ingredients: ["Nuggets de poulet (6 pièces)", "Frites", "Boisson"] },
      { name: "6 Onion Rings", price: 6, description: "Anneaux dorés et fondants aux saveurs d'oignon", category: "tex-mex", image: "images/n3.jpg", ingredients: ["Rondelles d'oignon panées (6 pièces)"] },
      { name: "Menu 6 Onion Rings", price: 8, description: "Formule complète avec ces spécialités américaines", category: "tex-mex", image: "images/n4.png", hasDrink: true, drinkOptions: drinkOptions, ingredients: ["Rondelles d'oignon panées (6 pièces)", "Frites", "Boisson"] },
      { name: "6 Mozzarella Sticks", price: 6, description: "Bâtonnets fondants au cœur coulant de fromage", category: "tex-mex", image: "images/n5.jpg", ingredients: ["Bâtonnets de mozzarella panés (6 pièces)"] },
      { name: "Menu 6 Mozzarella Sticks", price: 8, description: "Formule complète avec ces délices fromagés", category: "tex-mex", image: "images/n6.png", hasDrink: true, drinkOptions: drinkOptions, ingredients: ["Bâtonnets de mozzarella panés (6 pièces)", "Frites", "Boisson"] },
      { name: "6 Tenders", price: 8, description: "Lamelles de poulet tendres et épicées", category: "tex-mex", image: "images/n7.jpg", ingredients: ["Tenders de poulet (6 pièces)"] },
      { name: "Menu 6 Tenders", price: 10, description: "Formule complète avec ces spécialités de poulet", category: "tex-mex", image: "images/n8.png", hasDrink: true, drinkOptions: drinkOptions, ingredients: ["Tenders de poulet (6 pièces)", "Frites", "Boisson"] },
      { name: "Frites (Petite)", price: 2.5, description: "Accompagnement doré et croustillant format individuel", category: "fries", image: "images/f1.jpg", ingredients: ["Pommes de terre frites"] },
      { name: "Frites (Moyenne)", price: 3.5, description: "Accompagnement doré format standard", category: "fries", image: "images/f2.jpg", ingredients: ["Pommes de terre frites"] },
      { name: "Frites (Grande)", price: 4.5, description: "Accompagnement doré format généreux à partager", category: "fries", image: "images/f3.jpg", ingredients: ["Pommes de terre frites"] },
      { name: "Frites Cheddar", price: 4.5, description: "Frites dorées généreusement nappées de cheddar fondant", category: "fries", image: "images/f77.jpg", ingredients: ["Pommes de terre frites", "Cheddar"] },
      { name: "Frites Fromagère", price: 4.5, description: "Frites croustillantes recouvertes d'une sauce fromagère onctueuse", category: "fries", image: "images/f78.jpg", ingredients: ["Pommes de terre frites", "Sauce fromagère"] },
      { name: "Frites Crispy", price: 5.5, description: "Frites avec cheddar fondant et oignons frits croustillants", category: "fries", image: "images/f79.jpg", ingredients: ["Pommes de terre frites", "Cheddar", "Oignons frits"] },
      { name: "Frites Bacon", price: 6, description: "Frites gourmandes au cheddar coulant et bacon grillé", category: "fries", image: "images/f80.jpg", ingredients: ["Pommes de terre frites", "Cheddar", "Bacon"] },
      { name: "Box Tenders, Wings, Mix", price: 19, description: "Assortiment varié pour les amateurs de volaille (1kg)", category: "tex-mex", image: "images/n9.jpg", ingredients: ["Tenders de poulet", "Ailes de poulet", "Mix varié"] },
      { name: "Box Tenders, Wings, Mix", price: 23, description: "Formule complète avec assortiment varié (1kg)", category: "tex-mex", image: "images/n9.jpg", hasDrink: true, drinkOptions: drinkOptions, ingredients: ["Tenders de poulet", "Ailes de poulet", "Mix varié", "Frites", "Boisson"] },
      { name: "Box Tenders, Wings, Mix", price: 29, description: "Mega assortiment pour grande tablée (2kg)", category: "tex-mex", image: "images/n9.jpg", ingredients: ["Tenders de poulet", "Ailes de poulet", "Mix varié"] },
      { name: "Box Tenders, Wings, Mix", price: 33, description: "Mega formule complète pour grande tablée (2kg)", category: "tex-mex", image: "images/n9.jpg", hasDrink: true, drinkOptions: drinkOptions, ingredients: ["Tenders de poulet", "Ailes de poulet", "Mix varié", "Frites", "Boisson"] },
      { name: "6 Calamar seul", price: 6, description: "Anneaux de calamar panés et croustillants", category: "tex-mex", image: "images/calamar.jpg", ingredients: ["Anneaux de calamar panés (6 pièces)"] },
      { name: "6 jalapenos seul", price: 8, description: "Piments jalapeños farcis au fromage, panés et dorés", category: "tex-mex", image: "images/jalapenos.jpg", ingredients: ["Jalapeños farcis au fromage (6 pièces)"] },
      { name: "6 bouchées de camembert seul", price: 6, description: "Délicieuses bouchées de camembert panées et fondantes", category: "tex-mex", image: "images/boucher.jpg", ingredients: ["Bouchées de camembert panées (6 pièces)"] },
      { name: "menu Calamar ", price: 8, description: "Formule complète avec anneaux de calamar croustillants", category: "tex-mex", image: "images/menu_calamar.png", hasDrink: true, drinkOptions: drinkOptions, ingredients: ["Anneaux de calamar panés (6 pièces)", "Frites", "Boisson"] },
      { name: "menu jalapenos", price: 10, description: "Formule complète avec jalapeños farcis épicés", category: "tex-mex", image: "images/menu_jalapenos.png", hasDrink: true, drinkOptions: drinkOptions, ingredients: ["Jalapeños farcis au fromage (6 pièces)", "Frites", "Boisson"] },
      { name: "menu bouchées de camembert", price: 8, description: "Formule complète avec bouchées de camembert fondantes", category: "tex-mex", image: "images/menu_bouchees_camembert.png", hasDrink: true, drinkOptions: drinkOptions, ingredients: ["Bouchées de camembert panées (6 pièces)", "Frites", "Boisson"] },
      { name: "6 Chicken Wings", price: 8, description: "Bouchées dorées et croustillantes pour petites faims", category: "tex-mex", image: "images/chicken wings.jpg", ingredients: ["Nuggets de poulet (6 pièces)"] },
      { name: "Menu 6 Chicken Wings", price: 10, description: "Formule complète avec accompagnements pour enfants", category: "tex-mex", image: "images/chicken wings menu.jpg", hasDrink: true, drinkOptions: drinkOptions, ingredients: ["Nuggets de poulet (6 pièces)", "Frites", "Boisson"] },

      // --- TACOS ---
      { name: "Tacos (1 Viande)", price: 8, description: "Spécialité tex-mex généreuse et savoureuse", category: "tacos", image: "images/t1.jpeg", ingredients: ["1 Viande au choix", "Sauce fromagère maison", "Frites"] },
      { name: "Tacos (2 Viandes)", price: 9.5, description: "Double plaisir pour les amateurs de viande", category: "tacos", image: "images/t2.jpg", ingredients: ["2 Viandes au choix", "Sauce fromagère maison", "Frites"] },
      { name: "Tacos (3 Viandes)", price: 11, description: "Le summum des tacos pour les gros appétits", category: "tacos", image: "images/t3.png", ingredients: ["3 Viandes au choix", "Sauce fromagère maison", "Frites"] },

      // --- TACO BOWL ---
      { name: "Taco Bowl (1 Viande)", price: 8, description: "Bol généreux avec 1 viande au choix", category: "taco_bowl", image: "images/taco bowl1.jpg", ingredients: ["1 Viande au choix", "Sauce fromagère maison", "Frites"] },
      { name: "Taco Bowl (2 Viandes)", price: 9.5, description: "Bol généreux avec 2 viandes au choix", category: "taco_bowl", image: "images/taco bowl.jfif", ingredients: ["2 Viandes au choix", "Sauce fromagère maison", "Frites"] },
      { name: "Taco Bowl (3 Viandes)", price: 11, description: "Bol généreux avec 3 viandes au choix", category: "taco_bowl", image: "images/taco bowl3.jfif", ingredients: ["3 Viandes au choix", "Sauce fromagère maison", "Frites"] },

      // --- Panini ---
      { name: "Thon", price: 5, description: "Sandwich italien grillé aux saveurs marines", category: "panini", image: "images/pa1.jpg", ingredients: ["Pain panini", "Thon", "Mozzarella", "Tomate", "Salade"] },
      { name: "Poulet", price: 5, description: "Sandwich italien grillé tendre et savoureux", category: "panini", image: "images/pa2.jpg", ingredients: ["Pain panini", "Poulet", "Mozzarella", "Tomate", "Salade"] },
      { name: "Viande hachée", price: 5, description: "Sandwich italien grillé généreux et consistant", category: "panini", image: "images/pa3.jpg", ingredients: ["Pain panini", "Viande hachée", "Mozzarella", "Tomate", "Salade"] },
      { name: "Thon (Menu)", price: 6, description: "Formule panini avec boisson rafraîchissante", category: "panini", image: "images/pa4.webp", hasDrink: true, drinkOptions: drinkOptions, ingredients: ["Pain panini", "Thon", "Mozzarella", "Tomate", "Salade", "Boisson"] },
      { name: "Poulet (Menu)", price: 6, description: "Formule panini avec boisson rafraîchissante", category: "panini", image: "images/pa4.webp", hasDrink: true, drinkOptions: drinkOptions, ingredients: ["Pain panini", "Poulet", "Mozzarella", "Tomate", "Salade", "Boisson"] },
      { name: "Viande hachée (Menu)", price: 6, description: "Formule panini avec boisson rafraîchissante", category: "panini", image: "images/pa4.webp", hasDrink: true, drinkOptions: drinkOptions, ingredients: ["Pain panini", "Viande hachée", "Mozzarella", "Tomate", "Salade", "Boisson"] },
      { name: "Jambon", price: 5, description: "Sandwich italien grillé aux saveurs marines", category: "panini", image: "images/panini jombon.jpg", ingredients: ["Pain panini", "Thon", "Mozzarella", "Tomate", "Salade"] },
      { name: "Jambon (Menu)", price: 6, description: "Formule panini avec boisson rafraîchissante", category: "panini", image: "images/panini jombon.jpg", hasDrink: true, drinkOptions: drinkOptions, ingredients: ["Pain panini", "Jambon", "Mozzarella", "Tomate", "Salade", "Boisson"] },
      { name: "Saumon", price: 5, description: "Sandwich italien grillé généreux et consistant", category: "panini", image: "images/panini saumon.jpg", ingredients: ["Pain panini", "Viande hachée", "Mozzarella", "Tomate", "Salade"] },
      { name: "Saumon (Menu)", price: 6, description: "Formule panini avec boisson rafraîchissante", category: "panini", image: "images/panini saumon.jpg", hasDrink: true, drinkOptions: drinkOptions, ingredients: ["Pain panini", "Thon", "Mozzarella", "Tomate", "Salade", "Boisson"] },
      { name: "4 Fromage", price: 5, description: "Formule panini avec boisson rafraîchissante", category: "panini", image: "images/panini 4 fromage.jpg", hasDrink: true, drinkOptions: drinkOptions, ingredients: ["Pain panini", "Poulet", "Mozzarella", "Tomate", "Salade", "Boisson"] },
      { name: "4 Fromage (Menu)", price: 6, description: "Formule panini avec boisson rafraîchissante", category: "panini", image: "images/panini 4 fromage.jpg", hasDrink: true, drinkOptions: drinkOptions, ingredients: ["Pain panini", "Viande hachée", "Mozzarella", "Tomate", "Salade", "Boisson"] },

      // --- SALADES ---
      { name: "Salade César", price: 7, description: "Classique américain revisité avec nos spécialités", category: "salade", image: "images/s1.jpg", ingredients: ["Salade verte", "Poulet grillé", "Tomate", "Olives", "Fromage Buffalo", "Sauce César"] },
      { name: "Salade Chèvre Chaud", price: 7, description: "Mélange gourmand entre tradition française et originalité", category: "salade", image: "images/s2.jpg", ingredients: ["Salade verte", "Lardons grillés", "Chèvre chaud sur toast", "Miel", "Tomate"] },
      { name: "Salade Fraîcheur", price: 8, description: "Composition légère et équilibrée aux produits de la mer", category: "salade", image: "images/s3.jpg", ingredients: ["Salade verte", "Saumon", "Thon", "Tomate", "Fromage Buffalo", "Olives"] },

      // sandwiches
      {
        name: "Sandwich Radical",
        price: 7.5,
        description: "Explosif et généreux : double steak juteux, cordon bleu croustillant et cheddar fondant dans une baguette grillée.",
        category: "Sandwichs",
        image: "images/Sandwich Radical.jpg",
        ingredients: ["Pain baguette", "2 Steaks 45g", "Cordon bleu", "Cheddar", "Salade", "Tomate", "Sauce au choix"],
        sauceOptions: ["Mayonnaise", "Ketchup", "Algérienne", "Blanche", "Samouraï", "Biggy", "Hannibal", "Curry", "Harissa", "Américaine", "Poivre", "Andalouse", "Barbecue"]
      },
      {
        name: "Sandwich Radical (Menu)",
        price: 9,
        description: "Formule complète du Radical avec frites dorées et boisson fraîche pour un repas ultra gourmand.",
        category: "Sandwichs",
        image: "images/Sandwich Radical.jpg",
        hasDrink: true,
        drinkOptions: drinkOptions,
        ingredients: ["Pain baguette", "2 Steaks 45g", "Cordon bleu", "Cheddar", "Salade", "Tomate", "Sauce au choix", "Frites", "Boisson"],
        sauceOptions: ["Mayonnaise", "Ketchup", "Algérienne", "Blanche", "Samouraï", "Biggy", "Hannibal", "Curry", "Harissa", "Américaine", "Poivre", "Andalouse", "Barbecue"]
      },

      {
        name: "Sandwich Fricadelle",
        price: 7.5,
        description: "Spécialité du Nord : fricadelle grillée et cheddar fondant pour une saveur authentique.",
        category: "Sandwichs",
        image: "images/Sandwich Fricadelle.jpg",
        ingredients: ["Pain baguette", "Fricadelle", "Cheddar", "Salade", "Tomate", "Sauce au choix"],
        sauceOptions: ["Mayonnaise", "Ketchup", "Algérienne", "Blanche", "Samouraï", "Biggy", "Hannibal", "Curry", "Harissa", "Américaine", "Poivre", "Andalouse", "Barbecue"]
      },
      {
        name: "Sandwich Fricadelle (Menu)",
        price: 9,
        description: "La fricadelle incontournable en version menu avec frites et boisson.",
        category: "Sandwichs",
        image: "images/Sandwich Fricadelle.jpg",
        hasDrink: true,
        drinkOptions: drinkOptions,
        ingredients: ["Pain baguette", "Fricadelle", "Cheddar", "Salade", "Tomate", "Sauce au choix", "Frites", "Boisson"],
        sauceOptions: ["Mayonnaise", "Ketchup", "Algérienne", "Blanche", "Samouraï", "Biggy", "Hannibal", "Curry", "Harissa", "Américaine", "Poivre", "Andalouse", "Barbecue"]
      },

      {
        name: "Sandwich Mexicanos",
        price: 7.5,
        description: "Saveur relevée façon street-food : Mexicanos épicé et cheddar fondant.",
        category: "Sandwichs",
        image: "images/Sandwich Mexicanos.jpg",
        ingredients: ["Pain baguette", "Viande Mexicanos", "Cheddar", "Salade", "Tomate", "Sauce au choix"],
        sauceOptions: ["Mayonnaise", "Ketchup", "Algérienne", "Blanche", "Samouraï", "Biggy", "Hannibal", "Curry", "Harissa", "Américaine", "Poivre", "Andalouse", "Barbecue"]
      },
      {
        name: "Sandwich Mexicanos (Menu)",
        price: 9,
        description: "Version épicée complète : Mexicanos, frites croustillantes et boisson.",
        category: "Sandwichs",
        image: "images/Sandwich Mexicanos.jpg",
        hasDrink: true,
        drinkOptions: drinkOptions,
        ingredients: ["Pain baguette", "Viande Mexicanos", "Cheddar", "Salade", "Tomate", "Sauce au choix", "Frites", "Boisson"],
        sauceOptions: ["Mayonnaise", "Ketchup", "Algérienne", "Blanche", "Samouraï", "Biggy", "Hannibal", "Curry", "Harissa", "Américaine", "Poivre", "Andalouse", "Barbecue"]
      },

      {
        name: "Sandwich Mixte",
        price: 7.5,
        description: "Alliance parfaite poulet tendre et kebab grillé avec cheddar fondant.",
        category: "Sandwichs",
        image: "images/Sandwich Mixte.jpg",
        ingredients: ["Pain baguette", "Poulet", "Viande Kebab", "Cheddar", "Salade", "Tomate", "Sauce au choix"],
        sauceOptions: ["Mayonnaise", "Ketchup", "Algérienne", "Blanche", "Samouraï", "Biggy", "Hannibal", "Curry", "Harissa", "Américaine", "Poivre", "Andalouse", "Barbecue"]
      },
      {
        name: "Sandwich Mixte (Menu)",
        price: 9,
        description: "Le Mixte en formule généreuse avec frites et boisson incluse.",
        category: "Sandwichs",
        image: "images/Sandwich Mixte.jpg",
        hasDrink: true,
        drinkOptions: drinkOptions,
        ingredients: ["Pain baguette", "Poulet", "Viande Kebab", "Cheddar", "Salade", "Tomate", "Sauce au choix", "Frites", "Boisson"],
        sauceOptions: ["Mayonnaise", "Ketchup", "Algérienne", "Blanche", "Samouraï", "Biggy", "Hannibal", "Curry", "Harissa", "Américaine", "Poivre", "Andalouse", "Barbecue"]
      },

      {
        name: "Sandwich Chicken Tikka",
        price: 7.5,
        description: "Poulet mariné façon tikka, légèrement épicé et rehaussé de cheddar.",
        category: "Sandwichs",
        image: "images/Sandwich Chicken Tikka.jpg",
        ingredients: ["Pain baguette", "Poulet Tikka", "Cheddar", "Salade", "Tomate", "Sauce au choix"],
        sauceOptions: ["Mayonnaise", "Ketchup", "Algérienne", "Blanche", "Samouraï", "Biggy", "Hannibal", "Curry", "Harissa", "Américaine", "Poivre", "Andalouse", "Barbecue"]
      },
      {
        name: "Sandwich Chicken Tikka (Menu)",
        price: 9,
        description: "Poulet tikka mariné accompagné de frites croustillantes et boisson.",
        category: "Sandwichs",
        image: "images/Sandwich Chicken Tikka.jpg",
        hasDrink: true,
        drinkOptions: drinkOptions,
        ingredients: ["Pain baguette", "Poulet Tikka", "Cheddar", "Salade", "Tomate", "Sauce au choix", "Frites", "Boisson"],
        sauceOptions: ["Mayonnaise", "Ketchup", "Algérienne", "Blanche", "Samouraï", "Biggy", "Hannibal", "Curry", "Harissa", "Américaine", "Poivre", "Andalouse", "Barbecue"]
      },

      {
        name: "Sandwich Kebab",
        price: 7.5,
        description: "Grand classique à la viande de kebab grillée et sauce blanche onctueuse.",
        category: "Sandwichs",
        image: "images/Sandwich Kebab.jpg",
        ingredients: ["Pain baguette", "Viande Kebab", "Salade", "Tomate", "Oignons", "Sauce blanche"],
        sauceOptions: ["Mayonnaise", "Ketchup", "Algérienne", "Blanche", "Samouraï", "Biggy", "Hannibal", "Curry", "Harissa", "Américaine", "Poivre", "Andalouse", "Barbecue"]
      },
      {
        name: "Sandwich Kebab (Menu)",
        price: 9,
        description: "Sandwich kebab traditionnel servi avec frites et boisson.",
        category: "Sandwichs",
        image: "images/Sandwich Kebab.jpg",
        hasDrink: true,
        drinkOptions: drinkOptions,
        ingredients: ["Pain baguette", "Viande Kebab", "Salade", "Tomate", "Oignons", "Sauce blanche", "Frites", "Boisson"],
        sauceOptions: ["Mayonnaise", "Ketchup", "Algérienne", "Blanche", "Samouraï", "Biggy", "Hannibal", "Curry", "Harissa", "Américaine", "Poivre", "Andalouse", "Barbecue"]
      },

      {
        name: "Sandwich Américain",
        price: 7.5,
        description: "Version française du snack US : double steak, œuf coulant et cheddar.",
        category: "Sandwichs",
        image: "images/Sandwich Américain.jpg",
        ingredients: ["Pain baguette", "2 Steaks 45g", "Œuf", "Cheddar", "Salade", "Tomate", "Sauce au choix"],
        sauceOptions: ["Mayonnaise", "Ketchup", "Algérienne", "Blanche", "Samouraï", "Biggy", "Hannibal", "Curry", "Harissa", "Américaine", "Poivre", "Andalouse", "Barbecue"]
      },
      {
        name: "Sandwich Américain (Menu)",
        price: 9,
        description: "Formule complète du sandwich américain avec frites et boisson rafraîchissante.",
        category: "Sandwichs",
        image: "images/Sandwich Américain.jpg",
        hasDrink: true,
        drinkOptions: drinkOptions,
        ingredients: ["Pain baguette", "2 Steaks 45g", "Œuf", "Cheddar", "Salade", "Tomate", "Sauce au choix", "Frites", "Boisson"],
        sauceOptions: ["Mayonnaise", "Ketchup", "Algérienne", "Blanche", "Samouraï", "Biggy", "Hannibal", "Curry", "Harissa", "Américaine", "Poivre", "Andalouse", "Barbecue"]
      },

      // --- ASSIETTES ---
      {
        name: "Assiette Kebab",
        price: 12,
        description: "Assiette complète avec viande de kebab grillée, accompagnée de crudités fraîches, frites dorées et boisson.",
        category: "assiettes",
        image: "images/imaagee.png",
        hasDrink: true,
        drinkOptions: drinkOptions,
        ingredients: ["Viande Kebab", "Crudités", "Frites", "Boisson"],
        
      },
      {
        name: "Assiette Steak",
        price: 12,
        description: "Assiette complète avec steak juteux, accompagnée de crudités fraîches, frites dorées et boisson.",
        category: "assiettes",
        image: "images/steak.png",
        hasDrink: true,
        drinkOptions: drinkOptions,
        ingredients: ["Steak", "Crudités", "Frites", "Boisson"],
        
      },
      {
        name: "Assiette Tenders",
        price: 12,
        description: "Assiette complète avec tenders croustillants, accompagnée de crudités fraîches, frites dorées et boisson.",
        category: "assiettes",
        image: "images/111.jpg",
        hasDrink: true,
        drinkOptions: drinkOptions,
        ingredients: ["Tenders", "Crudités", "Frites", "Boisson"],
        
      },
      {
        name: "Assiette Chicken",
        price: 12,
        description: "Assiette complète avec poulet grillé tendre, accompagnée de crudités fraîches, frites dorées et boisson.",
        category: "assiettes",
        image: "images/222.jpg",
        hasDrink: true,
        drinkOptions: drinkOptions,
        ingredients: ["Chicken", "Crudités", "Frites", "Boisson"],
        
      },

      // --- CROUSTY ---
      {
        name: "Crousty",
        price: 9,
        description: "Bol de riz parfumé à la sauce thaï maison, garni de tenders croustillants, oignons frits et persil frais.",
        category: "crousty",
        image: "images/333.jpg",
        ingredients: ["Riz", "Sauce Thaï maison", "Oignons frits", "Persil", "Tenders"],
        croustySupplements: [
          { name: "Sauce Thaï", price: 0.5 },
          { name: "Poulet", price: 2 },
          { name: "Riz", price: 1 },
          { name: "Barquette Riz", price: 4 }
        ]
      },
      {
        name: "Crousty (Menu)",
        price: 10,
        description: "Formule Crousty complète avec boisson rafraîchissante incluse.",
        category: "crousty",
        image: "images/444.jpg",
        hasDrink: true,
        drinkOptions: drinkOptions,
        ingredients: ["Riz", "Sauce Thaï maison", "Oignons frits", "Persil", "Tenders", "Boisson"],
        croustySupplements: [
          { name: "Sauce Thaï", price: 0.5 },
          { name: "Poulet", price: 2 },
          { name: "Riz", price: 1 },
          { name: "Barquette Riz", price: 4 }
        ]
      },
      {
        name: "Crousty (Formule)",
        price: 12,
        description: "Formule Crousty complète avec boisson et dessert pour un repas gourmand.",
        category: "crousty",
        image: "images/555.jpg",
        hasDrink: true,
        drinkOptions: drinkOptions,
        ingredients: ["Riz", "Sauce Thaï maison", "Oignons frits", "Persil", "Tenders", "Boisson", "Dessert"],
        croustySupplements: [
          { name: "Sauce Thaï", price: 0.5 },
          { name: "Poulet", price: 2 },
          { name: "Riz", price: 1 },
          { name: "Barquette Riz", price: 4 }
        ]
      },

      // --- DESSERTS ---


      {
        name: "Tiramisu",
        price: 3,
        description: "Douceur italienne authentique pour finir en beauté",
        category: "dessert",
        image: "images/d1.jpg",
        ingredients: ["Mascarpone", "Café", "Biscuits à la cuillère", "Cacao"]
      },
      {
        name: "Tarte au Daim",
        price: 3,
        description: "Gourmandise sucrée aux éclats de caramel croquant",
        category: "dessert",
        image: "images/d2.jpg",
        ingredients: ["Pâte sablée", "Chocolat", "Caramel", "Daim"]
      },
      {
        name: "Brownie",
        price: 2.5,
        description: "Moelleux au chocolat avec une touche fondante",
        category: "dessert",
        image: "images/d3.jpg",
        ingredients: ["Chocolat", "Beurre", "Sucre", "Œufs", "Farine"]
      },
      {
        name: "Haagen-Dazs 100ml",
        price: 4,
        description: "Glace premium en petit format pour un plaisir instantané",
        category: "dessert",
        image: "images/d4.jpg",
        ingredients: ["Selon parfum choisi"]
      },
      {
        name: "Haagen-Dazs 500ml",
        price: 8,
        description: "Grand format de glace premium pour partager (ou pas !)",
        category: "dessert",
        image: "images/d5.jpg",
        ingredients: ["Selon parfum choisi"]
      },
      // --- BOISSONS ---
      {
        name: "Canette 33cl",
        price: 0,
        description: "Large sélection de boissons rafraîchissantes en format pratique",
        category: "boissons",
        subcategory: "canette",
        image: "images/b.jpg",
        ingredients: ["Boisson en canette 33cl"],
        options: [
          { name: "Coca Cola", price: 1.5 },
          { name: "Coca Cola Zero", price: 1.5 },
          { name: "Coca Cola Cherry", price: 1.5 },
          { name: "Ice Tea Pêche", price: 1.5 },
          { name: "Perrier", price: 1.5 },
          { name: "Sprite", price: 1.5 },
          { name: "7up", price: 1.5 },
          { name: "Orangina", price: 1.5 },
          { name: "Oasis Tropical", price: 1.5 },
          { name: "Oasis Framboise", price: 1.5 },
          { name: "Fanta Orange", price: 1.5 },
          { name: "Fanta Citron", price: 1.5 },
          { name: "Tropico", price: 1.5 },
          { name: "Hawaï", price: 1.5 },
          { name: "7up Cherry", price: 1.5 },
          { name: "Schweppes Agrumes", price: 1.5 },
          { name: "Mojito (sans alcool)", price: 2 }
        ]
      },
      { name: "Eau Cristaline 50cl", price: 1, description: "Hydratation pure et naturelle en format individuel", category: "boissons", subcategory: "eaux", image: "images/eaux.jpg", ingredients: ["Eau minérale"] },
      { name: "Bouteille Coca 1.5L", price: 3.5, description: "Format famille de la boisson mythique américaine", category: "boissons", subcategory: "eaux", image: "images/coca.webp", ingredients: ["Coca-Cola"] },

      // --- Menu Enfant ---
      // { name: "Tacos 1 viande ", price: 7, description: "Formule enfant complète avec boisson et dessert", category: "menuenfant", image: "images/me1.jpg", ingredients: ["Galette de blé", "1 Viande", "Frites", "Capri-Sun", "Compote"] },
      { name: "Cheeseburger ", price: 7, description: "Formule enfant avec le classique américain", category: "menuenfant", image: "images/me2.jpg", ingredients: ["Pain burger", "Steak", "Cheddar", "Frites", "Capri-Sun", "Compote"] },
      { name: "5 nuggets ", price: 7, description: "Formule enfant avec les favoris des petits", category: "menuenfant", image: "images/me3.jpg", ingredients: ["Nuggets de poulet (5 pièces)", "Frites", "Capri-Sun", "Compote"] },

      // --- Menu pack ---
      { name: "3 Pizzas Junior au Choix, 1 Maxi Boisson ", price: 25, description: "Offre familiale économique: 3 pizzas format junior au choix et une grande boisson.", category: "menu_junior", image: "images/menu junior.png", ingredients: ["3 Pizzas Junior au choix", "1 Boisson 1.5L"] },
      { name: "2 Pizzas Senior au Choix, 2 Desserts, 1 Maxi Boisson ", price: 30, description: "Menu duo parfait: 2 pizzas format senior au choix, 2 desserts et une grande boisson à partager.", category: "menu_duo", image: "images/menu duo.png", ingredients: ["2 Pizzas Senior au choix", "2 Desserts", "1 Boisson 1.5L"] },
      { name: "2 Pizzas Maxi au Choix, 1 Maxi Boisson ", price: 33, description: "Menu généreux pour 3-4 personnes: 2 grandes pizzas au choix et une maxi boisson.", category: "menu_mega", image: "images/menu mega.png", ingredients: ["2 Pizzas Maxi au choix", "1 Boisson 1.5L"] },
    ];

    function loadProducts() {
      const grid = document.getElementById('product-grid');
      grid.innerHTML = '';

      // Charger les pizzas depuis pizzaProducts (une seule carte par type)
      if (typeof pizzaProducts !== 'undefined') {
        pizzaProducts.forEach(pizza => {
          const col = document.createElement('div');
          col.className = `col-xl-4-custom col-lg-4 col-md-6 col-sm-12 all ${pizza.category}`;

          // Trouver le prix minimum pour l'affichage
          const minPrice = Math.min(...pizza.sizes.map(s => s.price));

          col.innerHTML = `
            <div class="product-card" onclick="showProductDetails('${pizza.name.replace(/'/g, "\\'")}', '${(pizza.ingredients || []).join(', ').replace(/'/g, "\\'")}', ${minPrice}, '${pizza.image}')">
              <div class="img-box">
                <img src="${pizza.image}" alt="${pizza.name}">
              </div>
              <div class="detail-box">
                <h5>${pizza.name}</h5>
                <p>${pizza.baseDescription}</p>
                <div class="options">
                  <h6>À partir de €${minPrice}</h6>
                  <button class="add-to-cart-btn" onclick="event.stopPropagation(); openPizzaSizeModal('${pizza.name.replace(/'/g, "\\'")}')">
                    Choisir la taille
                  </button>
                </div>
              </div>
            </div>
          `;
          grid.appendChild(col);
        });
      }

      // Charger les autres produits normalement
      products.forEach(product => {
        const col = document.createElement('div');
        col.className = `col-xl-4-custom col-lg-4 col-md-6 col-sm-12 all ${product.category}`;

        // Vérifier si le produit a des options (comme les canettes) ou une boisson incluse
        const hasOptions = product.options && product.options.length > 0;
        const hasDrink = product.hasDrink && product.drinkOptions;
        const isTacos = product.category === 'tacos';
        const isTacoBowl = product.category === 'taco_bowl';
        const isBurger = product.category === 'burger';
        const isSandwich = product.category === 'Sandwichs';
        const isCrousty = product.category === 'crousty';
        const hasAssietteDrinkOptions = product.category === 'assiettes' && product.hasDrink;
        const isMenuJunior = product.name.includes('3 Pizzas Junior au Choix');
        const isMenuDuo = product.name.includes('2 Pizzas Senior au Choix');
        const isMenuMega = product.name.includes('2 Pizzas Maxi au Choix');

        // Vérifier si le produit nécessite une personnalisation de sauce
        const needsSauceCustomization = (isTacoBowl || isBurger || isSandwich) && !hasDrink;
        const needsSauceAndDrinkCustomization = isSandwich && hasDrink;

        let priceDisplay, buttonText, buttonAction;

        if (isTacos) {
          priceDisplay = `À partir de $${product.price}`;
          buttonText = 'Personnaliser';
          buttonAction = `openTacosCustomization('${product.name}', ${product.price})`;
        } else if (isTacoBowl) {
          priceDisplay = `À partir de €${product.price}`;
          buttonText = 'Choisir';
          buttonAction = `openTacoBowlCustomization('${product.name}', ${product.price})`;
        } else if (isCrousty) {
          priceDisplay = `€${product.price}`;
          buttonText = 'Choisir';
          buttonAction = `openCroustyCustomization('${product.name.replace(/'/g, "\\'")}', ${product.price})`;
        } else if (hasAssietteDrinkOptions) {
          priceDisplay = `€${product.price}`;
          buttonText = 'Choisir';
          buttonAction = `openAssietteDrinkModal('${product.name.replace(/'/g, "\\'")}', ${product.price})`;
        } else if (needsSauceAndDrinkCustomization) {
          priceDisplay = `€${product.price}`;
          buttonText = 'Choisir';
          buttonAction = `openSandwichMenuCustomization('${product.name}', ${product.price})`;
        } else if (needsSauceCustomization) {
          priceDisplay = `€${product.price}`;
          buttonText = 'Choisir';
          buttonAction = `openSauceCustomization('${product.name}', ${product.price}, '${product.category}')`;
        } else if (isMenuJunior) {
          priceDisplay = `€${product.price}`;
          buttonText = 'Choisir';
          buttonAction = `openMenuJuniorModal('${product.name}', ${product.price})`;
        } else if (isMenuDuo) {
          priceDisplay = `€${product.price}`;
          buttonText = 'Choisir';
          buttonAction = `openMenuDuoModal('${product.name}', ${product.price})`;
        } else if (isMenuMega) {
          priceDisplay = `€${product.price}`;
          buttonText = 'Choisir';
          buttonAction = `openMenuMegaModal('${product.name}', ${product.price})`;
        } else if (hasOptions) {
          priceDisplay = 'Choisir';
          buttonText = 'Choisir';
          buttonAction = `openCanetteModal('${product.name}')`;
        } else if (hasDrink) {
          priceDisplay = `€${product.price}`;
          buttonText = 'Choisir';
          buttonAction = `openMenuDrinkModal('${product.name}', ${product.price})`;
        } else {
          priceDisplay = `€${product.price}`;
          buttonText = 'Ajouter au panier';
          buttonAction = `addToCart('${product.name}', ${product.price})`;
        }

        col.innerHTML = `
      <div class="product-card" onclick="showProductDetails('${product.name.replace(/'/g, "\\'")}', '${(product.ingredients || []).join(', ').replace(/'/g, "\\'")}', ${product.price}, '${product.image}')">
      <div class="img-box">
        <img src="${product.image}" alt="${product.name}">
      </div>
      <div class="detail-box">
        <h5>${product.name}</h5>
        <p>${product.description}</p>
        <div class="options">
        <h6>${priceDisplay}</h6>
        <button class="add-to-cart-btn" onclick="event.stopPropagation(); ${buttonAction}">
        ${buttonText}
        </button>
        </div>
      </div>
      </div>
      `;
        grid.appendChild(col);
      });
    }

    // Fonction pour ouvrir la modal de personnalisation des taco bowls
    function openTacoBowlCustomization(productName, basePrice) {
      // Créer la modal dynamiquement
      const modal = document.createElement('div');
      modal.className = 'modal fade';
      modal.id = 'tacoBowlCustomModal';
      modal.setAttribute('tabindex', '-1');
      modal.setAttribute('role', 'dialog');
      modal.setAttribute('aria-hidden', 'true');

      // Déterminer le nombre de viandes selon le produit
      let maxViandes = 1;
      if (productName.includes('2 Viandes')) maxViandes = 2;
      if (productName.includes('3 Viandes')) maxViandes = 3;

      modal.innerHTML = `
      <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content" style="background: var(--card-bg); color: var(--text-primary); border: 1px solid var(--border-color);">
        <div class="modal-header" style="border-bottom: 1px solid var(--border-color);">
          <h5 class="modal-title" style="color: var(--text-primary);">Personnaliser votre ${productName}</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="color: var(--text-primary); opacity: 0.8;">
          <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body" style="background: var(--card-bg); max-height: 70vh; overflow-y: auto;">
          <!-- Sélection des viandes -->
          <div class="mb-4">
          <h6 style="color: var(--accent-color); margin-bottom: 15px;">
            <i class="fa fa-cutlery"></i> Choisissez ${maxViandes} viande${maxViandes > 1 ? 's' : ''} :
          </h6>
          <div class="row" id="tacobowl-viandes-selection">
            ${tacosData.viandes.map(viande => `
            <div class="col-md-4 mb-2">
              <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px; transition: all 0.3s ease;">
              <input type="checkbox" name="tacobowl-viande" value="${viande}" onchange="updateTacoBowlViandeSelection(${maxViandes})" style="margin-right: 8px;">
              <span style="color: var(--text-primary);">${viande}</span>
              </label>
            </div>
            `).join('')}
          </div>
          </div>

          <!-- Sélection des sauces -->
          <div class="mb-4">
          <h6 style="color: var(--accent-color); margin-bottom: 15px;">
            <i class="fa fa-tint"></i> Choisissez vos sauces :
          </h6>
          <div class="row" id="tacobowl-sauces-selection">
            ${tacosData.sauces.map(sauce => `
            <div class="col-md-4 mb-2">
              <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px; transition: all 0.3s ease;">
              <input type="checkbox" name="tacobowl-sauce" value="${sauce}" style="margin-right: 8px;">
              <span style="color: var(--text-primary);">${sauce}</span>
              </label>
            </div>
            `).join('')}
          </div>
          </div>

          <!-- Suppléments -->
          <div class="mb-4">
          <h6 style="color: var(--accent-color); margin-bottom: 15px;">
            <i class="fa fa-plus"></i> Suppléments (+1€ chacun) :
          </h6>
          <div class="row" id="tacobowl-supplements-selection">
            ${tacosData.supplements.map(supplement => `
            <div class="col-md-4 mb-2">
              <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px; transition: all 0.3s ease;">
              <input type="checkbox" name="tacobowl-supplement" value="${supplement}" style="margin-right: 8px;">
              <span style="color: var(--text-primary);">${supplement} <small style="color: var(--accent-color);">(+1€)</small></span>
              </label>
            </div>
            `).join('')}
          </div>
          </div>
        </div>
        <div class="modal-footer" style="border-top: 1px solid var(--border-color); background: var(--card-bg);">
          <button type="button" class="btn btn-secondary" data-dismiss="modal" style="background: var(--border-color); color: var(--text-primary); border: 1px solid var(--border-color);">Annuler</button>
          <button type="button" class="btn btn-primary" onclick="addCustomTacoBowlToCart('${productName}', ${basePrice})" style="background: linear-gradient(135deg, var(--accent-color), var(--accent-hover)); border: none;">
          Ajouter au panier
          </button>
        </div>
        </div>
      </div>
      `;

      document.body.appendChild(modal);
      $('#tacoBowlCustomModal').modal('show');

      $('#tacoBowlCustomModal').on('hidden.bs.modal', function () {
        modal.remove();
      });
    }

    // Fonction pour limiter la sélection des viandes pour taco bowl
    function updateTacoBowlViandeSelection(maxViandes) {
      const checkboxes = document.querySelectorAll('input[name="tacobowl-viande"]');
      const checkedBoxes = document.querySelectorAll('input[name="tacobowl-viande"]:checked');

      if (checkedBoxes.length >= maxViandes) {
        checkboxes.forEach(checkbox => {
          if (!checkbox.checked) {
            checkbox.disabled = true;
            checkbox.parentElement.style.opacity = '0.5';
          }
        });
      } else {
        checkboxes.forEach(checkbox => {
          checkbox.disabled = false;
          checkbox.parentElement.style.opacity = '1';
        });
      }
    }

    // Fonction pour ajouter le taco bowl personnalisé au panier
    function addCustomTacoBowlToCart(productName, basePrice) {
      const viandes = Array.from(document.querySelectorAll('input[name="tacobowl-viande"]:checked')).map(cb => cb.value);
      const sauces = Array.from(document.querySelectorAll('input[name="tacobowl-sauce"]:checked')).map(cb => cb.value);
      const supplements = Array.from(document.querySelectorAll('input[name="tacobowl-supplement"]:checked')).map(cb => cb.value);

      if (viandes.length === 0) {
        alert('Veuillez sélectionner au moins une viande.');
        return;
      }

      const supplementPrice = supplements.length * 1;
      const totalPrice = basePrice + supplementPrice;

      let customName = productName;
      if (viandes.length > 0) {
        customName += ` (${viandes.join(', ')})`;
      }
      if (sauces.length > 0) {
        customName += ` - Sauces: ${sauces.join(', ')}`;
      }
      if (supplements.length > 0) {
        customName += ` - Suppléments: ${supplements.join(', ')}`;
      }

      addToCart(customName, totalPrice);
      $('#tacoBowlCustomModal').modal('hide');
    }

    // Fonction pour ouvrir la modal de personnalisation Crousty
    function openCroustyCustomization(productName, basePrice, hasDrink) {
      const product = products.find(p => p.name === productName && p.category === 'crousty');
      if (!product || !product.croustySupplements) {
        console.error('Produit Crousty non trouvé:', productName);
        return;
      }

      const modal = document.createElement('div');
      modal.className = 'modal fade';
      modal.id = 'croustyCustomModal';
      modal.setAttribute('tabindex', '-1');
      modal.setAttribute('role', 'dialog');
      modal.setAttribute('aria-hidden', 'true');

      modal.innerHTML = `
      <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content" style="background: var(--card-bg); color: var(--text-primary); border: 1px solid var(--border-color);">
        <div class="modal-header" style="border-bottom: 1px solid var(--border-color); background: linear-gradient(135deg, var(--accent-color), var(--accent-hover)); color: white;">
          <h5 class="modal-title" style="color: white;">${productName}</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="color: white; opacity: 0.9;">
          <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body" style="background: var(--card-bg);">
          
          <!-- Suppléments Crousty -->
          <div class="mb-4">
          <h6 style="color: var(--accent-color); margin-bottom: 15px;">
            <i class="fa fa-plus"></i> Suppléments :
          </h6>
          <div class="row" id="crousty-supplements-selection">
            ${product.croustySupplements.map(supplement => `
            <div class="col-md-6 mb-2">
              <label class="custom-checkbox" style="display: flex; align-items: center; justify-content: space-between; cursor: pointer; padding: 12px; border: 1px solid var(--border-color); border-radius: 8px; transition: all 0.3s ease;">
              <div style="display: flex; align-items: center;">
                <input type="checkbox" name="crousty-supplement" value="${supplement.name}" data-price="${supplement.price}" style="margin-right: 10px;">
                <span style="color: var(--text-primary);">${supplement.name}</span>
              </div>
              <small style="color: var(--accent-color); font-weight: bold;">+${supplement.price}€</small>
              </label>
            </div>
            `).join('')}
          </div>
          </div>

          ${hasDrink ? `
          <!-- Choix de boisson -->
          <div class="mb-4">
          <h6 style="color: var(--accent-color); margin-bottom: 15px;">
            <i class="fa fa-glass"></i> Choisir votre boisson :
          </h6>
          <div class="row" id="crousty-drink-selection">
            ${drinkOptions.map(drink => `
            <div class="col-md-4 col-sm-6 mb-2">
              <label class="custom-radio" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px; transition: all 0.3s ease;">
              <input type="radio" name="crousty-drink" value="${drink.name}" style="margin-right: 8px;" ${drink.name === "Coca Cola" ? 'checked' : ''}>
              <span style="color: var(--text-primary);">${drink.name}</span>
              </label>
            </div>
            `).join('')}
          </div>
          </div>
          ` : ''}
          
        </div>
        <div class="modal-footer" style="border-top: 1px solid var(--border-color); background: var(--card-bg);">
          <button type="button" class="btn btn-secondary" data-dismiss="modal" style="background: var(--border-color); color: var(--text-primary); border: 1px solid var(--border-color);">Annuler</button>
          <button type="button" class="btn btn-primary" onclick="addCustomCroustyToCart('${productName}', ${basePrice}, ${hasDrink})" style="background: linear-gradient(135deg, var(--accent-color), var(--accent-hover)); border: none;">
          Ajouter au panier
          </button>
        </div>
        </div>
      </div>
      `;

      document.body.appendChild(modal);
      $('#croustyCustomModal').modal('show');

      $('#croustyCustomModal').on('hidden.bs.modal', function () {
        modal.remove();
      });
    }

    // Fonction pour ajouter le Crousty personnalisé au panier
    function addCustomCroustyToCart(productName, basePrice, hasDrink) {
      const supplements = Array.from(document.querySelectorAll('input[name="crousty-supplement"]:checked'));
      
      let supplementsPrice = 0;
      let supplementsNames = [];
      
      supplements.forEach(checkbox => {
        const price = parseFloat(checkbox.dataset.price);
        supplementsPrice += price;
        supplementsNames.push(checkbox.value);
      });

      const totalPrice = basePrice + supplementsPrice;
      let customName = productName;
      
      if (hasDrink) {
        const selectedDrink = document.querySelector('input[name="crousty-drink"]:checked');
        if (selectedDrink) {
          customName += ` - ${selectedDrink.value}`;
        }
      }
      
      if (supplementsNames.length > 0) {
        customName += ` - Suppléments: ${supplementsNames.join(', ')}`;
      }

      addToCart(customName, totalPrice);
      $('#croustyCustomModal').modal('hide');
    }

    // Fonction pour ouvrir la modal de choix de boisson pour les assiettes
    function openAssietteDrinkModal(productName, basePrice) {
      const modal = document.createElement('div');
      modal.className = 'modal fade';
      modal.id = 'assietteDrinkModal';
      modal.setAttribute('tabindex', '-1');
      modal.setAttribute('role', 'dialog');
      modal.setAttribute('aria-hidden', 'true');

      modal.innerHTML = `
      <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content" style="background: var(--card-bg); color: var(--text-primary); border: 1px solid var(--border-color);">
        <div class="modal-header" style="border-bottom: 1px solid var(--border-color); background: linear-gradient(135deg, var(--accent-color), var(--accent-hover)); color: white;">
          <h5 class="modal-title" style="color: white;">${productName} - ${basePrice}€</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="color: white; opacity: 0.9;">
          <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body" style="background: var(--card-bg);">
          
          <!-- Choix de boisson -->
          <div class="mb-4">
          <h6 style="color: var(--accent-color); margin-bottom: 15px;">
            <i class="fa fa-glass"></i> Choisir votre boisson :
          </h6>
          <div class="row" id="assiette-drink-selection">
            ${drinkOptions.map(drink => `
            <div class="col-md-4 col-sm-6 mb-2">
              <label class="custom-radio" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px; transition: all 0.3s ease;">
              <input type="radio" name="assiette-drink" value="${drink.name}" style="margin-right: 8px;" ${drink.name === "Coca Cola" ? 'checked' : ''}>
              <span style="color: var(--text-primary);">${drink.name}</span>
              </label>
            </div>
            `).join('')}
          </div>
          </div>
          
        </div>
        <div class="modal-footer" style="border-top: 1px solid var(--border-color); background: var(--card-bg);">
          <button type="button" class="btn btn-secondary" data-dismiss="modal" style="background: var(--border-color); color: var(--text-primary); border: 1px solid var(--border-color);">Annuler</button>
          <button type="button" class="btn btn-primary" onclick="addAssietteDrinkToCart('${productName}', ${basePrice})" style="background: linear-gradient(135deg, var(--accent-color), var(--accent-hover)); border: none;">
          Ajouter au panier
          </button>
        </div>
        </div>
      </div>
      `;

      document.body.appendChild(modal);
      $('#assietteDrinkModal').modal('show');

      $('#assietteDrinkModal').on('hidden.bs.modal', function () {
        modal.remove();
      });
    }

    // Fonction pour ajouter l'assiette avec boisson au panier
    function addAssietteDrinkToCart(productName, basePrice) {
      const selectedDrink = document.querySelector('input[name="assiette-drink"]:checked');
      
      let customName = productName;
      if (selectedDrink) {
        customName += ` - ${selectedDrink.value}`;
      }

      addToCart(customName, basePrice);
      $('#assietteDrinkModal').modal('hide');
    }

    // Fonction pour ouvrir la modal de sélection de taille de pizza
    function openPizzaSizeModal(pizzaName) {
      // Trouver la pizza dans pizzaProducts
      const pizza = pizzaProducts.find(p => p.name === pizzaName);
      if (!pizza) {
        console.error('Pizza non trouvée:', pizzaName);
        return;
      }

      const modal = document.createElement('div');
      modal.className = 'modal fade';
      modal.id = 'pizzaSizeModal';
      modal.setAttribute('tabindex', '-1');
      modal.setAttribute('role', 'dialog');
      modal.setAttribute('aria-hidden', 'true');

      modal.innerHTML = `
      <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content" style="background: var(--card-bg); color: var(--text-primary); border: 1px solid var(--border-color);">
          <div class="modal-header" style="border-bottom: 1px solid var(--border-color);">
            <h5 class="modal-title" style="color: var(--text-primary);">Choisissez la taille de votre ${pizza.name}</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="color: var(--text-primary); opacity: 0.8;">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body" style="background: var(--card-bg); padding: 30px;">
            <div class="row">
              ${pizza.sizes.map((sizeInfo, index) => `
                <div class="col-md-4 mb-3">
                  <div class="size-option" style="
                    background: var(--darker-bg);
                    border: 2px solid var(--border-color);
                    border-radius: 15px;
                    padding: 20px;
                    text-align: center;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    height: 100%;
                  " 
                  onclick="selectPizzaSize('${pizza.name}', '${sizeInfo.size}', ${sizeInfo.price})"
                  onmouseover="this.style.borderColor='var(--accent-color)'; this.style.transform='translateY(-5px)'"
                  onmouseout="this.style.borderColor='var(--border-color)'; this.style.transform='translateY(0)'">
                    <div style="
                      font-size: 48px;
                      color: var(--accent-color);
                      margin-bottom: 15px;
                    ">
                      🍕
                    </div>
                    <h4 style="color: var(--accent-color); font-weight: bold; margin-bottom: 10px;">
                      ${sizeInfo.size}
                    </h4>
                    <p style="color: var(--text-secondary); font-size: 14px; margin-bottom: 15px; min-height: 60px;">
                      ${sizeInfo.description}
                    </p>
                    <div style="
                      font-size: 28px;
                      font-weight: bold;
                      color: var(--text-primary);
                      margin-top: auto;
                    ">
                      €${sizeInfo.price.toFixed(2)}
                    </div>
                  </div>
                </div>
              `).join('')}
            </div>
            
            <div style="margin-top: 20px; padding: 15px; background: var(--darker-bg); border-radius: 10px;">
              <h6 style="color: var(--accent-color); margin-bottom: 10px;">
                <i class="fa fa-info-circle"></i> Ingrédients:
              </h6>
              <p style="color: var(--text-secondary); margin: 0;">
                ${pizza.ingredients.join(', ')}
              </p>
            </div>
          </div>
        </div>
      </div>
      `;

      document.body.appendChild(modal);
      $('#pizzaSizeModal').modal('show');

      $('#pizzaSizeModal').on('hidden.bs.modal', function () {
        modal.remove();
      });
    }

    // Fonction pour sélectionner une taille de pizza et l'ajouter au panier
    function selectPizzaSize(pizzaName, size, price) {
      const fullName = `${pizzaName} (${size})`;
      addToCart(fullName, price);
      $('#pizzaSizeModal').modal('hide');
    }

    // Fonction pour ouvrir la modal de personnalisation des sauces (burgers et sandwichs sans menu)
    function openSauceCustomization(productName, basePrice, category) {
      const modal = document.createElement('div');
      modal.className = 'modal fade';
      modal.id = 'sauceCustomModal';
      modal.setAttribute('tabindex', '-1');
      modal.setAttribute('role', 'dialog');
      modal.setAttribute('aria-hidden', 'true');

      modal.innerHTML = `
      <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content" style="background: var(--card-bg); color: var(--text-primary); border: 1px solid var(--border-color);">
        <div class="modal-header" style="border-bottom: 1px solid var(--border-color);">
          <h5 class="modal-title" style="color: var(--text-primary);">Personnaliser votre ${productName}</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="color: var(--text-primary); opacity: 0.8;">
          <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body" style="background: var(--card-bg);">
          <!-- Sélection des sauces -->
          <div class="mb-4">
          <h6 style="color: var(--accent-color); margin-bottom: 15px;">
            <i class="fa fa-tint"></i> Choisissez vos sauces :
          </h6>
          <div class="row" id="sauce-selection">
            ${tacosData.sauces.map(sauce => `
            <div class="col-md-4 mb-2">
              <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px; transition: all 0.3s ease;">
              <input type="checkbox" name="sauce-choice" value="${sauce}" style="margin-right: 8px;">
              <span style="color: var(--text-primary);">${sauce}</span>
              </label>
            </div>
            `).join('')}
          </div>
          </div>
        </div>
        <div class="modal-footer" style="border-top: 1px solid var(--border-color); background: var(--card-bg);">
          <button type="button" class="btn btn-secondary" data-dismiss="modal" style="background: var(--border-color); color: var(--text-primary); border: 1px solid var(--border-color);">Annuler</button>
          <button type="button" class="btn btn-primary" onclick="addCustomSauceProductToCart('${productName}', ${basePrice})" style="background: linear-gradient(135deg, var(--accent-color), var(--accent-hover)); border: none;">
          Ajouter au panier
          </button>
        </div>
        </div>
      </div>
      `;

      document.body.appendChild(modal);
      $('#sauceCustomModal').modal('show');

      $('#sauceCustomModal').on('hidden.bs.modal', function () {
        modal.remove();
      });
    }

    // Fonction pour ajouter un produit avec sauce personnalisée au panier
    function addCustomSauceProductToCart(productName, basePrice) {
      const sauces = Array.from(document.querySelectorAll('input[name="sauce-choice"]:checked')).map(cb => cb.value);

      let customName = productName;
      if (sauces.length > 0) {
        customName += ` - Sauces: ${sauces.join(', ')}`;
      }

      addToCart(customName, basePrice);
      $('#sauceCustomModal').modal('hide');
    }

    // Fonction pour ouvrir la modal de personnalisation des sandwichs avec menu (sauce + boisson)
    function openSandwichMenuCustomization(productName, basePrice) {
      const product = products.find(p => p.name === productName);

      const modal = document.createElement('div');
      modal.className = 'modal fade';
      modal.id = 'sandwichMenuCustomModal';
      modal.setAttribute('tabindex', '-1');
      modal.setAttribute('role', 'dialog');
      modal.setAttribute('aria-hidden', 'true');

      modal.innerHTML = `
      <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content" style="background: var(--card-bg); color: var(--text-primary); border: 1px solid var(--border-color);">
        <div class="modal-header" style="border-bottom: 1px solid var(--border-color);">
          <h5 class="modal-title" style="color: var(--text-primary);">Personnaliser votre ${productName}</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="color: var(--text-primary); opacity: 0.8;">
          <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body" style="background: var(--card-bg); max-height: 70vh; overflow-y: auto;">
          <!-- Sélection des sauces -->
          <div class="mb-4">
          <h6 style="color: var(--accent-color); margin-bottom: 15px;">
            <i class="fa fa-tint"></i> Choisissez vos sauces :
          </h6>
          <div class="row" id="sandwich-sauce-selection">
            ${tacosData.sauces.map(sauce => `
            <div class="col-md-4 mb-2">
              <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px; transition: all 0.3s ease;">
              <input type="checkbox" name="sandwich-sauce" value="${sauce}" style="margin-right: 8px;">
              <span style="color: var(--text-primary);">${sauce}</span>
              </label>
            </div>
            `).join('')}
          </div>
          </div>

          <!-- Sélection de la boisson -->
          <div class="mb-4">
          <h6 style="color: var(--accent-color); margin-bottom: 15px;">
            <i class="fa fa-glass"></i> Choisissez votre boisson :
          </h6>
          <div class="row" id="sandwich-drink-selection">
            ${(product.drinkOptions || drinkOptions).map(drink => `
            <div class="col-md-4 mb-2">
              <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px; transition: all 0.3s ease;">
              <input type="radio" name="sandwich-drink" value="${drink.name}" style="margin-right: 8px;">
              <span style="color: var(--text-primary);">${drink.name}</span>
              </label>
            </div>
            `).join('')}
          </div>
          </div>
        </div>
        <div class="modal-footer" style="border-top: 1px solid var(--border-color); background: var(--card-bg);">
          <button type="button" class="btn btn-secondary" data-dismiss="modal" style="background: var(--border-color); color: var(--text-primary); border: 1px solid var(--border-color);">Annuler</button>
          <button type="button" class="btn btn-primary" onclick="addCustomSandwichMenuToCart('${productName}', ${basePrice})" style="background: linear-gradient(135deg, var(--accent-color), var(--accent-hover)); border: none;">
          Ajouter au panier
          </button>
        </div>
        </div>
      </div>
      `;

      document.body.appendChild(modal);
      $('#sandwichMenuCustomModal').modal('show');

      $('#sandwichMenuCustomModal').on('hidden.bs.modal', function () {
        modal.remove();
      });
    }

    // Fonction pour ajouter un sandwich menu personnalisé au panier
    function addCustomSandwichMenuToCart(productName, basePrice) {
      const sauces = Array.from(document.querySelectorAll('input[name="sandwich-sauce"]:checked')).map(cb => cb.value);
      const selectedDrink = document.querySelector('input[name="sandwich-drink"]:checked');

      if (!selectedDrink) {
        alert('Veuillez sélectionner une boisson.');
        return;
      }

      let customName = productName;
      if (sauces.length > 0) {
        customName += ` - Sauces: ${sauces.join(', ')}`;
      }
      customName += ` + ${selectedDrink.value}`;

      addToCart(customName, basePrice);
      $('#sandwichMenuCustomModal').modal('hide');
    }

    // Fonction pour ouvrir la modal Menu Junior (3 Pizzas Junior + 1 Boisson)
    function openMenuJuniorModal(productName, basePrice) {
      // Utiliser pizzaProducts au lieu de products
      const juniorPizzas = (typeof pizzaProducts !== 'undefined') ? pizzaProducts : [];

      const modal = document.createElement('div');
      modal.className = 'modal fade';
      modal.id = 'menuJuniorModal';
      modal.setAttribute('tabindex', '-1');
      modal.setAttribute('role', 'dialog');
      modal.setAttribute('aria-hidden', 'true');

      modal.innerHTML = `
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
          <div class="modal-content" style="background: var(--card-bg); color: var(--text-primary); border: 1px solid var(--border-color);">
            <div class="modal-header" style="border-bottom: 1px solid var(--border-color);">
              <h5 class="modal-title" style="color: var(--text-primary);">🍕 Composez votre ${productName}</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="color: var(--text-primary); opacity: 0.8;">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body" style="background: var(--card-bg); max-height: 70vh; overflow-y: auto;">
              <!-- Sélection des 3 pizzas Junior -->
              <div class="mb-4">
                <h6 style="color: var(--accent-color); margin-bottom: 15px;">
                  <i class="fa fa-pizza-slice"></i> Choisissez 3 Pizzas Junior :
                </h6>
                <div class="row" id="junior-pizzas-selection">
                  ${juniorPizzas.map((pizza, index) => `
                    <div class="col-md-4 mb-3">
                      <div class="card pizza-option" data-pizza="${pizza.name}" style="background: var(--darker-bg); border: 1px solid var(--border-color); border-radius: 15px; cursor: pointer; transition: all 0.3s ease;" 
                           onclick="selectJuniorPizza('${pizza.name.replace(/'/g, "\\'")}', ${index})">
                        <img src="${pizza.image}" class="card-img-top" style="height: 150px; object-fit: cover; border-radius: 15px 15px 0 0;">
                        <div class="card-body text-center" style="padding: 15px;">
                          <h6 class="card-title" style="color: var(--text-primary); font-size: 14px;">${pizza.name}</h6>
                          <p style="color: var(--text-secondary); font-size: 11px; margin: 5px 0;">${pizza.baseDescription || ''}</p>
                          <div class="quantity-selector" style="display: none; margin-top: 10px;">
                            <button type="button" class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); updateJuniorQuantity(${index}, -1)">-</button>
                            <span class="quantity-display" style="margin: 0 10px; color: var(--accent-color); font-weight: bold;">0</span>
                            <button type="button" class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); updateJuniorQuantity(${index}, 1)">+</button>
                          </div>
                        </div>
                      </div>
                    </div>
                  `).join('')}
                </div>
                <div id="junior-pizza-counter" style="text-align: center; color: var(--accent-color); font-weight: bold; margin-top: 10px;">
                  Pizzas sélectionnées: <span id="junior-selected-count">0</span>/3
                </div>
              </div>

              <!-- Sélection de la boisson -->
              <div class="mb-4">
                <h6 style="color: var(--accent-color); margin-bottom: 15px;">
                  <i class="fa fa-glass"></i> Choisissez votre boisson 1.5L :
                </h6>
                <div class="row" id="junior-drink-selection">
                  <div class="col-md-4 mb-2">
                    <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px;">
                      <input type="radio" name="junior-drink" value="Coca Cola 1.5L" style="margin-right: 8px;">
                      <span style="color: var(--text-primary);">Coca Cola 1.5L</span>
                    </label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px;">
                      <input type="radio" name="junior-drink" value="Coca Zero 1.5L" style="margin-right: 8px;">
                      <span style="color: var(--text-primary);">Coca Zero 1.5L</span>
                    </label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px;">
                      <input type="radio" name="junior-drink" value="Sprite 1.5L" style="margin-right: 8px;">
                      <span style="color: var(--text-primary);">Sprite 1.5L</span>
                    </label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px;">
                      <input type="radio" name="junior-drink" value="Fanta 1.5L" style="margin-right: 8px;">
                      <span style="color: var(--text-primary);">Fanta 1.5L</span>
                    </label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px;">
                      <input type="radio" name="junior-drink" value="Orangina 1.5L" style="margin-right: 8px;">
                      <span style="color: var(--text-primary);">Orangina 1.5L</span>
                    </label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px;">
                      <input type="radio" name="junior-drink" value="Eau 1.5L" style="margin-right: 8px;">
                      <span style="color: var(--text-primary);">Eau 1.5L</span>
                    </label>
                  </div>
                </div>
              </div>
            </div>
            <div class="modal-footer" style="border-top: 1px solid var(--border-color); background: var(--card-bg);">
              <button type="button" class="btn btn-secondary" data-dismiss="modal" style="background: var(--border-color); color: var(--text-primary);">Annuler</button>
              <button type="button" class="btn btn-primary" onclick="addMenuJuniorToCart('${productName}', ${basePrice})" style="background: linear-gradient(135deg, var(--accent-color), var(--accent-hover)); border: none;">
                Ajouter au panier
              </button>
            </div>
          </div>
        </div>
      `;

      document.body.appendChild(modal);
      $('#menuJuniorModal').modal('show');

      // Nettoyer la modal quand elle se ferme
      $('#menuJuniorModal').on('hidden.bs.modal', function () {
        modal.remove();
      });
    }

    // Variables pour le suivi des sélections Junior
    let juniorSelectedPizzas = {};
    let juniorTotalSelected = 0;

    function selectJuniorPizza(pizzaName, index) {
      if (juniorTotalSelected < 3) {
        updateJuniorQuantity(index, 1);
      }
    }

    function updateJuniorQuantity(index, change) {
      const pizzaCards = document.querySelectorAll('#junior-pizzas-selection .pizza-option');
      const card = pizzaCards[index];
      const pizzaName = card.getAttribute('data-pizza');
      const quantityDisplay = card.querySelector('.quantity-display');
      const quantitySelector = card.querySelector('.quantity-selector');

      if (!juniorSelectedPizzas[pizzaName]) {
        juniorSelectedPizzas[pizzaName] = 0;
      }

      const newQuantity = Math.max(0, juniorSelectedPizzas[pizzaName] + change);
      const totalAfterChange = juniorTotalSelected - juniorSelectedPizzas[pizzaName] + newQuantity;

      if (totalAfterChange <= 3 && newQuantity >= 0) {
        juniorTotalSelected = totalAfterChange;
        juniorSelectedPizzas[pizzaName] = newQuantity;

        quantityDisplay.textContent = newQuantity;

        if (newQuantity > 0) {
          quantitySelector.style.display = 'block';
          card.style.borderColor = 'var(--accent-color)';
          card.style.background = 'rgba(255, 107, 53, 0.1)';
        } else {
          quantitySelector.style.display = 'none';
          card.style.borderColor = 'var(--border-color)';
          card.style.background = 'var(--darker-bg)';
        }

        document.getElementById('junior-selected-count').textContent = juniorTotalSelected;
      }
    }

    function addMenuJuniorToCart(productName, basePrice) {
      if (juniorTotalSelected !== 3) {
        alert('Veuillez sélectionner exactement 3 pizzas.');
        return;
      }

      const selectedDrink = document.querySelector('input[name="junior-drink"]:checked');
      if (!selectedDrink) {
        alert('Veuillez sélectionner une boisson.');
        return;
      }

      // Ajouter le menu complet au panier avec la mention de la taille
      const selectedPizzasList = Object.entries(juniorSelectedPizzas)
        .filter(([name, qty]) => qty > 0)
        .map(([name, qty]) => `${name} (Junior) x${qty}`)
        .join(', ');

      const menuDescription = `${productName} (${selectedPizzasList} + ${selectedDrink.value})`;
      addToCart(menuDescription, basePrice);

      // Reset et fermer
      juniorSelectedPizzas = {};
      juniorTotalSelected = 0;
      $('#menuJuniorModal').modal('hide');
    }

    // Fonction pour ouvrir la modal Menu Duo (2 Pizzas Senior + 2 Desserts + 1 Boisson)
    function openMenuDuoModal(productName, basePrice) {
      // Utiliser pizzaProducts au lieu de products
      const seniorPizzas = (typeof pizzaProducts !== 'undefined') ? pizzaProducts : [];
      const desserts = products.filter(p => p.category === 'dessert');

      const modal = document.createElement('div');
      modal.className = 'modal fade';
      modal.id = 'menuDuoModal';
      modal.setAttribute('tabindex', '-1');
      modal.setAttribute('role', 'dialog');
      modal.setAttribute('aria-hidden', 'true');

      modal.innerHTML = `
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
          <div class="modal-content" style="background: var(--card-bg); color: var(--text-primary); border: 1px solid var(--border-color);">
            <div class="modal-header" style="border-bottom: 1px solid var(--border-color);">
              <h5 class="modal-title" style="color: var(--text-primary);">🍕 Composez votre ${productName}</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="color: var(--text-primary); opacity: 0.8;">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body" style="background: var(--card-bg); max-height: 70vh; overflow-y: auto;">
              <!-- Sélection des 2 pizzas Senior -->
              <div class="mb-4">
                <h6 style="color: var(--accent-color); margin-bottom: 15px;">
                  <i class="fa fa-pizza-slice"></i> Choisissez 2 Pizzas Senior :
                </h6>
                <div class="row" id="duo-pizzas-selection">
                  ${seniorPizzas.map((pizza, index) => `
                    <div class="col-md-3 mb-3">
                      <div class="card pizza-option" data-pizza="${pizza.name}" style="background: var(--darker-bg); border: 1px solid var(--border-color); border-radius: 15px; cursor: pointer; transition: all 0.3s ease;" 
                           onclick="selectDuoPizza('${pizza.name.replace(/'/g, "\\'")}', ${index})">
                        <img src="${pizza.image}" class="card-img-top" style="height: 120px; object-fit: cover; border-radius: 15px 15px 0 0;">
                        <div class="card-body text-center" style="padding: 10px;">
                          <h6 class="card-title" style="color: var(--text-primary); font-size: 12px;">${pizza.name}</h6>
                          <div class="quantity-selector" style="display: none; margin-top: 10px;">
                            <button type="button" class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); updateDuoQuantity(${index}, -1)">-</button>
                            <span class="quantity-display" style="margin: 0 10px; color: var(--accent-color); font-weight: bold;">0</span>
                            <button type="button" class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); updateDuoQuantity(${index}, 1)">+</button>
                          </div>
                        </div>
                      </div>
                    </div>
                  `).join('')}
                </div>
                <div id="duo-pizza-counter" style="text-align: center; color: var(--accent-color); font-weight: bold; margin-top: 10px;">
                  Pizzas sélectionnées: <span id="duo-selected-count">0</span>/2
                </div>
              </div>

              <!-- Sélection des 2 desserts -->
              <div class="mb-4">
                <h6 style="color: var(--accent-color); margin-bottom: 15px;">
                  <i class="fa fa-birthday-cake"></i> Choisissez 2 Desserts :
                </h6>
                <div class="row" id="duo-desserts-selection">
                  ${desserts.map((dessert, index) => `
                    <div class="col-md-3 mb-3">
                      <div class="card dessert-option" data-dessert="${dessert.name}" style="background: var(--darker-bg); border: 1px solid var(--border-color); border-radius: 15px; cursor: pointer; transition: all 0.3s ease;" 
                           onclick="selectDuoDessert('${dessert.name}', ${index})">
                        <img src="${dessert.image}" class="card-img-top" style="height: 120px; object-fit: cover; border-radius: 15px 15px 0 0;">
                        <div class="card-body text-center" style="padding: 10px;">
                          <h6 class="card-title" style="color: var(--text-primary); font-size: 12px;">${dessert.name}</h6>
                          <div class="quantity-selector" style="display: none; margin-top: 10px;">
                            <button type="button" class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); updateDuoDessertQuantity(${index}, -1)">-</button>
                            <span class="quantity-display" style="margin: 0 10px; color: var(--accent-color); font-weight: bold;">0</span>
                            <button type="button" class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); updateDuoDessertQuantity(${index}, 1)">+</button>
                          </div>
                        </div>
                      </div>
                    </div>
                  `).join('')}
                </div>
                <div id="duo-dessert-counter" style="text-align: center; color: var(--accent-color); font-weight: bold; margin-top: 10px;">
                  Desserts sélectionnés: <span id="duo-dessert-selected-count">0</span>/2
                </div>
              </div>

              <!-- Sélection de la boisson -->
              <div class="mb-4">
                <h6 style="color: var(--accent-color); margin-bottom: 15px;">
                  <i class="fa fa-glass"></i> Choisissez votre boisson 1.5L :
                </h6>
                <div class="row" id="duo-drink-selection">
                  <div class="col-md-4 mb-2">
                    <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px;">
                      <input type="radio" name="duo-drink" value="Coca Cola 1.5L" style="margin-right: 8px;">
                      <span style="color: var(--text-primary);">Coca Cola 1.5L</span>
                    </label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px;">
                      <input type="radio" name="duo-drink" value="Coca Zero 1.5L" style="margin-right: 8px;">
                      <span style="color: var(--text-primary);">Coca Zero 1.5L</span>
                    </label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px;">
                      <input type="radio" name="duo-drink" value="Sprite 1.5L" style="margin-right: 8px;">
                      <span style="color: var(--text-primary);">Sprite 1.5L</span>
                    </label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px;">
                      <input type="radio" name="duo-drink" value="Fanta 1.5L" style="margin-right: 8px;">
                      <span style="color: var(--text-primary);">Fanta 1.5L</span>
                    </label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px;">
                      <input type="radio" name="duo-drink" value="Orangina 1.5L" style="margin-right: 8px;">
                      <span style="color: var(--text-primary);">Orangina 1.5L</span>
                    </label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px;">
                      <input type="radio" name="duo-drink" value="Eau 1.5L" style="margin-right: 8px;">
                      <span style="color: var(--text-primary);">Eau 1.5L</span>
                    </label>
                  </div>
                </div>
              </div>
            </div>
            <div class="modal-footer" style="border-top: 1px solid var(--border-color); background: var(--card-bg);">
              <button type="button" class="btn btn-secondary" data-dismiss="modal" style="background: var(--border-color); color: var(--text-primary);">Annuler</button>
              <button type="button" class="btn btn-primary" onclick="addMenuDuoToCart('${productName}', ${basePrice})" style="background: linear-gradient(135deg, var(--accent-color), var(--accent-hover)); border: none;">
                Ajouter au panier
              </button>
            </div>
          </div>
        </div>
      `;

      document.body.appendChild(modal);
      $('#menuDuoModal').modal('show');

      $('#menuDuoModal').on('hidden.bs.modal', function () {
        modal.remove();
      });
    }

    // Variables pour le suivi des sélections Duo
    let duoSelectedPizzas = {};
    let duoTotalSelected = 0;
    let duoSelectedDesserts = {};
    let duoTotalDesserts = 0;

    function selectDuoPizza(pizzaName, index) {
      if (duoTotalSelected < 2) {
        updateDuoQuantity(index, 1);
      }
    }

    function updateDuoQuantity(index, change) {
      const pizzaCards = document.querySelectorAll('#duo-pizzas-selection .pizza-option');
      const card = pizzaCards[index];
      const pizzaName = card.getAttribute('data-pizza');
      const quantityDisplay = card.querySelector('.quantity-display');
      const quantitySelector = card.querySelector('.quantity-selector');

      if (!duoSelectedPizzas[pizzaName]) {
        duoSelectedPizzas[pizzaName] = 0;
      }

      const newQuantity = Math.max(0, duoSelectedPizzas[pizzaName] + change);
      const totalAfterChange = duoTotalSelected - duoSelectedPizzas[pizzaName] + newQuantity;

      if (totalAfterChange <= 2 && newQuantity >= 0) {
        duoTotalSelected = totalAfterChange;
        duoSelectedPizzas[pizzaName] = newQuantity;

        quantityDisplay.textContent = newQuantity;

        if (newQuantity > 0) {
          quantitySelector.style.display = 'block';
          card.style.borderColor = 'var(--accent-color)';
          card.style.background = 'rgba(255, 107, 53, 0.1)';
        } else {
          quantitySelector.style.display = 'none';
          card.style.borderColor = 'var(--border-color)';
          card.style.background = 'var(--darker-bg)';
        }

        document.getElementById('duo-selected-count').textContent = duoTotalSelected;
      }
    }

    function selectDuoDessert(dessertName, index) {
      if (duoTotalDesserts < 2) {
        updateDuoDessertQuantity(index, 1);
      }
    }

    function updateDuoDessertQuantity(index, change) {
      const dessertCards = document.querySelectorAll('#duo-desserts-selection .dessert-option');
      const card = dessertCards[index];
      const dessertName = card.getAttribute('data-dessert');
      const quantityDisplay = card.querySelector('.quantity-display');
      const quantitySelector = card.querySelector('.quantity-selector');

      if (!duoSelectedDesserts[dessertName]) {
        duoSelectedDesserts[dessertName] = 0;
      }

      const newQuantity = Math.max(0, duoSelectedDesserts[dessertName] + change);
      const totalAfterChange = duoTotalDesserts - duoSelectedDesserts[dessertName] + newQuantity;

      if (totalAfterChange <= 2 && newQuantity >= 0) {
        duoTotalDesserts = totalAfterChange;
        duoSelectedDesserts[dessertName] = newQuantity;

        quantityDisplay.textContent = newQuantity;

        if (newQuantity > 0) {
          quantitySelector.style.display = 'block';
          card.style.borderColor = 'var(--accent-color)';
          card.style.background = 'rgba(255, 107, 53, 0.1)';
        } else {
          quantitySelector.style.display = 'none';
          card.style.borderColor = 'var(--border-color)';
          card.style.background = 'var(--darker-bg)';
        }

        document.getElementById('duo-dessert-selected-count').textContent = duoTotalDesserts;
      }
    }

    function addMenuDuoToCart(productName, basePrice) {
      if (duoTotalSelected !== 2) {
        alert('Veuillez sélectionner exactement 2 pizzas.');
        return;
      }

      if (duoTotalDesserts !== 2) {
        alert('Veuillez sélectionner exactement 2 desserts.');
        return;
      }

      const selectedDrink = document.querySelector('input[name="duo-drink"]:checked');
      if (!selectedDrink) {
        alert('Veuillez sélectionner une boisson.');
        return;
      }

      // Ajouter la mention de la taille Senior
      const selectedPizzasList = Object.entries(duoSelectedPizzas)
        .filter(([name, qty]) => qty > 0)
        .map(([name, qty]) => `${name} (Senior) x${qty}`)
        .join(', ');

      const selectedDessertsList = Object.entries(duoSelectedDesserts)
        .filter(([name, qty]) => qty > 0)
        .map(([name, qty]) => `${name} x${qty}`)
        .join(', ');

      const menuDescription = `${productName} (${selectedPizzasList} + ${selectedDessertsList} + ${selectedDrink.value})`;
      addToCart(menuDescription, basePrice);

      // Reset et fermer
      duoSelectedPizzas = {};
      duoTotalSelected = 0;
      duoSelectedDesserts = {};
      duoTotalDesserts = 0;
      $('#menuDuoModal').modal('hide');
    }

    // Fonction pour ouvrir la modal Menu Mega (2 Pizzas Maxi + 1 Boisson)
    function openMenuMegaModal(productName, basePrice) {
      // Utiliser pizzaProducts au lieu de products
      const maxiPizzas = (typeof pizzaProducts !== 'undefined') ? pizzaProducts : [];

      const modal = document.createElement('div');
      modal.className = 'modal fade';
      modal.id = 'menuMegaModal';
      modal.setAttribute('tabindex', '-1');
      modal.setAttribute('role', 'dialog');
      modal.setAttribute('aria-hidden', 'true');

      modal.innerHTML = `
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
          <div class="modal-content" style="background: var(--card-bg); color: var(--text-primary); border: 1px solid var(--border-color);">
            <div class="modal-header" style="border-bottom: 1px solid var(--border-color);">
              <h5 class="modal-title" style="color: var(--text-primary);">🍕 Composez votre ${productName}</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="color: var(--text-primary); opacity: 0.8;">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body" style="background: var(--card-bg); max-height: 70vh; overflow-y: auto;">
              <!-- Sélection des 2 pizzas Maxi -->
              <div class="mb-4">
                <h6 style="color: var(--accent-color); margin-bottom: 15px;">
                  <i class="fa fa-pizza-slice"></i> Choisissez 2 Pizzas Maxi :
                </h6>
                <div class="row" id="mega-pizzas-selection">
                  ${maxiPizzas.map((pizza, index) => `
                    <div class="col-md-3 mb-3">
                      <div class="card pizza-option" data-pizza="${pizza.name}" style="background: var(--darker-bg); border: 1px solid var(--border-color); border-radius: 15px; cursor: pointer; transition: all 0.3s ease;" 
                           onclick="selectMegaPizza('${pizza.name.replace(/'/g, "\\'")}', ${index})">
                        <img src="${pizza.image}" class="card-img-top" style="height: 120px; object-fit: cover; border-radius: 15px 15px 0 0;">
                        <div class="card-body text-center" style="padding: 10px;">
                          <h6 class="card-title" style="color: var(--text-primary); font-size: 12px;">${pizza.name}</h6>
                          <div class="quantity-selector" style="display: none; margin-top: 10px;">
                            <button type="button" class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); updateMegaQuantity(${index}, -1)">-</button>
                            <span class="quantity-display" style="margin: 0 10px; color: var(--accent-color); font-weight: bold;">0</span>
                            <button type="button" class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); updateMegaQuantity(${index}, 1)">+</button>
                          </div>
                        </div>
                      </div>
                    </div>
                  `).join('')}
                </div>
                <div id="mega-pizza-counter" style="text-align: center; color: var(--accent-color); font-weight: bold; margin-top: 10px;">
                  Pizzas sélectionnées: <span id="mega-selected-count">0</span>/2
                </div>
              </div>

              <!-- Sélection de la boisson -->
              <div class="mb-4">
                <h6 style="color: var(--accent-color); margin-bottom: 15px;">
                  <i class="fa fa-glass"></i> Choisissez votre boisson 1.5L :
                </h6>
                <div class="row" id="mega-drink-selection">
                  <div class="col-md-4 mb-2">
                    <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px;">
                      <input type="radio" name="mega-drink" value="Coca Cola 1.5L" style="margin-right: 8px;">
                      <span style="color: var(--text-primary);">Coca Cola 1.5L</span>
                    </label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px;">
                      <input type="radio" name="mega-drink" value="Coca Zero 1.5L" style="margin-right: 8px;">
                      <span style="color: var(--text-primary);">Coca Zero 1.5L</span>
                    </label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px;">
                      <input type="radio" name="mega-drink" value="Sprite 1.5L" style="margin-right: 8px;">
                      <span style="color: var(--text-primary);">Sprite 1.5L</span>
                    </label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px;">
                      <input type="radio" name="mega-drink" value="Fanta 1.5L" style="margin-right: 8px;">
                      <span style="color: var(--text-primary);">Fanta 1.5L</span>
                    </label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px;">
                      <input type="radio" name="mega-drink" value="Orangina 1.5L" style="margin-right: 8px;">
                      <span style="color: var(--text-primary);">Orangina 1.5L</span>
                    </label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px;">
                      <input type="radio" name="mega-drink" value="Eau 1.5L" style="margin-right: 8px;">
                      <span style="color: var(--text-primary);">Eau 1.5L</span>
                    </label>
                  </div>
                </div>
              </div>
            </div>
            <div class="modal-footer" style="border-top: 1px solid var(--border-color); background: var(--card-bg);">
              <button type="button" class="btn btn-secondary" data-dismiss="modal" style="background: var(--border-color); color: var(--text-primary);">Annuler</button>
              <button type="button" class="btn btn-primary" onclick="addMenuMegaToCart('${productName}', ${basePrice})" style="background: linear-gradient(135deg, var(--accent-color), var(--accent-hover)); border: none;">
                Ajouter au panier
              </button>
            </div>
          </div>
        </div>
      `;

      document.body.appendChild(modal);
      $('#menuMegaModal').modal('show');

      $('#menuMegaModal').on('hidden.bs.modal', function () {
        modal.remove();
      });
    }

    // Variables pour le suivi des sélections Mega
    let megaSelectedPizzas = {};
    let megaTotalSelected = 0;

    function selectMegaPizza(pizzaName, index) {
      if (megaTotalSelected < 2) {
        updateMegaQuantity(index, 1);
      }
    }

    function updateMegaQuantity(index, change) {
      const pizzaCards = document.querySelectorAll('#mega-pizzas-selection .pizza-option');
      const card = pizzaCards[index];
      const pizzaName = card.getAttribute('data-pizza');
      const quantityDisplay = card.querySelector('.quantity-display');
      const quantitySelector = card.querySelector('.quantity-selector');

      if (!megaSelectedPizzas[pizzaName]) {
        megaSelectedPizzas[pizzaName] = 0;
      }

      const newQuantity = Math.max(0, megaSelectedPizzas[pizzaName] + change);
      const totalAfterChange = megaTotalSelected - megaSelectedPizzas[pizzaName] + newQuantity;

      if (totalAfterChange <= 2 && newQuantity >= 0) {
        megaTotalSelected = totalAfterChange;
        megaSelectedPizzas[pizzaName] = newQuantity;

        quantityDisplay.textContent = newQuantity;

        if (newQuantity > 0) {
          quantitySelector.style.display = 'block';
          card.style.borderColor = 'var(--accent-color)';
          card.style.background = 'rgba(255, 107, 53, 0.1)';
        } else {
          quantitySelector.style.display = 'none';
          card.style.borderColor = 'var(--border-color)';
          card.style.background = 'var(--darker-bg)';
        }

        document.getElementById('mega-selected-count').textContent = megaTotalSelected;
      }
    }

    function addMenuMegaToCart(productName, basePrice) {
      if (megaTotalSelected !== 2) {
        alert('Veuillez sélectionner exactement 2 pizzas.');
        return;
      }

      const selectedDrink = document.querySelector('input[name="mega-drink"]:checked');
      if (!selectedDrink) {
        alert('Veuillez sélectionner une boisson.');
        return;
      }

      // Ajouter la mention de la taille Méga
      const selectedPizzasList = Object.entries(megaSelectedPizzas)
        .filter(([name, qty]) => qty > 0)
        .map(([name, qty]) => `${name} (Méga) x${qty}`)
        .join(', ');

      const menuDescription = `${productName} (${selectedPizzasList} + ${selectedDrink.value})`;
      addToCart(menuDescription, basePrice);

      // Reset et fermer
      megaSelectedPizzas = {};
      megaTotalSelected = 0;
      $('#menuMegaModal').modal('hide');
    }

    // Données pour la personnalisation des tacos
    const tacosData = {
      viandes: [
        'Kebab', 'Merguez', 'Steak', 'Cordon Bleu', 'Nuggets',
        'Tenders', 'Poulet', 'Fricadelle', 'Mexicanos'
      ],
      sauces: [
        'Mayonnaise', 'Ketchup', 'Algérienne', 'Blanche', 'Samouraï',
        'Biggy', 'Hannibal', 'Curry', 'Harissa', 'Américaine',
        'Poivre', 'Andalouse', 'Barbecue'
      ],
      supplements: [
        'Boursin', 'Maroilles', 'Cheddar', 'Raclette', 'Chèvre',
        'Gorgonzola', 'Bacon', 'Œuf', 'Crudités', 'Lardons'
      ]
    };

    // Fonction pour ouvrir la modal de personnalisation des tacos
    function openTacosCustomization(productName, basePrice) {
      // Créer la modal dynamiquement
      const modal = document.createElement('div');
      modal.className = 'modal fade';
      modal.id = 'tacosCustomModal';
      modal.setAttribute('tabindex', '-1');
      modal.setAttribute('role', 'dialog');
      modal.setAttribute('aria-hidden', 'true');

      // Déterminer le nombre de viandes selon le produit
      let maxViandes = 1;
      if (productName.includes('2 Viandes')) maxViandes = 2;
      if (productName.includes('3 Viandes')) maxViandes = 3;

      modal.innerHTML = `
        <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
          <div class="modal-content" style="background: var(--card-bg); color: var(--text-primary); border: 1px solid var(--border-color);">
            <div class="modal-header" style="border-bottom: 1px solid var(--border-color);">
              <h5 class="modal-title" style="color: var(--text-primary);">Personnaliser votre ${productName}</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="color: var(--text-primary); opacity: 0.8;">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body" style="background: var(--card-bg); max-height: 70vh; overflow-y: auto;">
              <!-- Sélection des viandes -->
              <div class="mb-4">
                <h6 style="color: var(--accent-color); margin-bottom: 15px;">
                  <i class="fa fa-cutlery"></i> Choisissez ${maxViandes} viande${maxViandes > 1 ? 's' : ''} :
                </h6>
                <div class="row" id="viandes-selection">
                  ${tacosData.viandes.map(viande => `
                    <div class="col-md-4 mb-2">
                      <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px; transition: all 0.3s ease;">
                        <input type="checkbox" name="viande" value="${viande}" onchange="updateViandeSelection(${maxViandes})" style="margin-right: 8px;">
                        <span style="color: var(--text-primary);">${viande}</span>
                      </label>
                    </div>
                  `).join('')}
                </div>
              </div>

              <!-- Sélection des sauces -->
              <div class="mb-4">
                <h6 style="color: var(--accent-color); margin-bottom: 15px;">
                  <i class="fa fa-tint"></i> Choisissez vos sauces :
                </h6>
                <div class="row" id="sauces-selection">
                  ${tacosData.sauces.map(sauce => `
                    <div class="col-md-4 mb-2">
                      <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px; transition: all 0.3s ease;">
                        <input type="checkbox" name="sauce" value="${sauce}" style="margin-right: 8px;">
                        <span style="color: var(--text-primary);">${sauce}</span>
                      </label>
                    </div>
                  `).join('')}
                </div>
              </div>

              <!-- Suppléments -->
              <div class="mb-4">
                <h6 style="color: var(--accent-color); margin-bottom: 15px;">
                  <i class="fa fa-plus"></i> Suppléments (+1€ chacun) :
                </h6>
                <div class="row" id="supplements-selection">
                  ${tacosData.supplements.map(supplement => `
                    <div class="col-md-4 mb-2">
                      <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px; transition: all 0.3s ease;">
                        <input type="checkbox" name="supplement" value="${supplement}" onchange="updateTacosPrice()" style="margin-right: 8px;">
                        <span style="color: var(--text-primary);">${supplement} <small style="color: var(--accent-color);">(+1€)</small></span>
                      </label>
                    </div>
                  `).join('')}
                </div>
              </div>

              <!-- Prix total -->
             <!-- <div class="text-center mb-3">
                <h5 style="color: var(--accent-color);">
                  Prix total: $<span id="tacos-total-price">${basePrice}</span>
                </h5>
              </div> -->
            </div>
            <div class="modal-footer" style="border-top: 1px solid var(--border-color); background: var(--card-bg);">
              <button type="button" class="btn btn-secondary" data-dismiss="modal" style="background: var(--border-color); color: var(--text-primary); border: 1px solid var(--border-color);">Annuler</button>
              <button type="button" class="btn btn-primary" onclick="addCustomTacosToCart('${productName}', ${basePrice})" style="background: linear-gradient(135deg, var(--accent-color), var(--accent-hover)); border: none;">
                Ajouter au panier
              </button>
            </div>
          </div>
        </div>

        <style>
          .custom-checkbox:hover {
            border-color: var(--accent-color) !important;
            background: rgba(255, 107, 53, 0.1) !important;
          }
          .custom-checkbox input:checked + span {
            color: var(--accent-color) !important;
            font-weight: bold;
          }
          .custom-checkbox:has(input:checked) {
            border-color: var(--accent-color) !important;
            background: rgba(255, 107, 53, 0.2) !important;
          }
        </style>
      `;

      document.body.appendChild(modal);
      $('#tacosCustomModal').modal('show');

      // Nettoyer la modal quand elle se ferme
      $('#tacosCustomModal').on('hidden.bs.modal', function () {
        modal.remove();
      });
    }

    // Fonction pour limiter la sélection des viandes
    function updateViandeSelection(maxViandes) {
      const checkboxes = document.querySelectorAll('input[name="viande"]');
      const checkedBoxes = document.querySelectorAll('input[name="viande"]:checked');

      if (checkedBoxes.length >= maxViandes) {
        checkboxes.forEach(checkbox => {
          if (!checkbox.checked) {
            checkbox.disabled = true;
            checkbox.parentElement.style.opacity = '0.5';
          }
        });
      } else {
        checkboxes.forEach(checkbox => {
          checkbox.disabled = false;
          checkbox.parentElement.style.opacity = '1';
        });
      }
    }

    // Fonction pour mettre à jour le prix des tacos
    function updateTacosPrice() {
      const basePrice = parseFloat(document.getElementById('tacos-total-price').textContent.split('$').pop()) || 0;
      const supplements = document.querySelectorAll('input[name="supplement"]:checked');
      const supplementPrice = supplements.length * 1; // 1€ par supplément

      // Récupérer le prix de base original depuis le bouton
      const originalPrice = parseFloat(document.querySelector('.btn-primary[onclick*="addCustomTacosToCart"]').getAttribute('onclick').match(/\d+/)[0]);
      const totalPrice = originalPrice + supplementPrice;

      document.getElementById('tacos-total-price').textContent = totalPrice;
    }

    // Fonction pour ajouter le tacos personnalisé au panier
    function addCustomTacosToCart(productName, basePrice) {
      const viandes = Array.from(document.querySelectorAll('input[name="viande"]:checked')).map(cb => cb.value);
      const sauces = Array.from(document.querySelectorAll('input[name="sauce"]:checked')).map(cb => cb.value);
      const supplements = Array.from(document.querySelectorAll('input[name="supplement"]:checked')).map(cb => cb.value);

      // Vérification: au moins une viande doit être sélectionnée
      if (viandes.length === 0) {
        alert('Veuillez sélectionner au moins une viande.');
        return;
      }

      // Calculer le prix total
      const supplementPrice = supplements.length * 1;
      const totalPrice = basePrice + supplementPrice;

      // Créer le nom personnalisé du produit
      let customName = productName;
      if (viandes.length > 0) {
        customName += ` (${viandes.join(', ')})`;
      }
      if (sauces.length > 0) {
        customName += ` - Sauces: ${sauces.join(', ')}`;
      }
      if (supplements.length > 0) {
        customName += ` - Suppléments: ${supplements.join(', ')}`;
      }

      // Ajouter au panier
      addToCart(customName, totalPrice);

      // Fermer la modal
      $('#tacosCustomModal').modal('hide');
    }

    // Function to show product details in a popup
    function showProductDetails(name, description, price, image) {
      const popup = document.createElement('div');
      popup.style.cssText = `
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10000;
      animation: fadeIn 0.3s ease;
      `;

      popup.innerHTML = `
      <div style="
        background: var(--card-bg);
        border-radius: 20px;
        max-width: 500px;
        width: 90%;
        max-height: 80vh;
        overflow-y: auto;
        position: relative;
        border: 1px solid var(--border-color);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.6);
        animation: slideUp 0.3s ease;
      ">
        <button onclick="this.closest('div').parentElement.remove()" style="
        position: absolute;
        top: 15px;
        right: 15px;
        background: var(--accent-color);
        color: white;
        border: none;
        border-radius: 50%;
        width: 35px;
        height: 35px;
        font-size: 18px;
        cursor: pointer;
        z-index: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        " onmouseover="this.style.background='var(--accent-hover)'" onmouseout="this.style.background='var(--accent-color)'">×</button>
        
        <div style="padding: 0;">
        <div style="
          width: 100%;
          height: 250px;
          background-image: url('${image}');
          background-size: cover;
          background-position: center;
          border-radius: 20px 20px 0 0;
          position: relative;
        ">
          <div style="
          position: absolute;
          bottom: 0;
          left: 0;
          right: 0;
          background: linear-gradient(transparent, rgba(0,0,0,0.8));
          padding: 20px;
          border-radius: 0 0 0 0;
          ">
          <h3 style="color: white; margin: 0; font-size: 24px; font-weight: bold;">${name}</h3>
          </div>
        </div>
        
        <div style="padding: 25px;">
          <p style="
          color: var(--text-secondary);
          font-size: 16px;
          line-height: 1.6;
          margin-bottom: 20px;
          ">${description}</p>
          
          <div style="
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding-top: 15px;
          border-top: 1px solid var(--border-color);
          ">
          <span style="
            font-size: 28px;
            font-weight: bold;
            color: var(--accent-color);
            text-shadow: 0 2px 4px rgba(255, 107, 53, 0.3);
          ">€${price}</span>
          
         
          </div>
        </div>
        </div>
      </div>
      `;

      // Close popup when clicking outside
      popup.addEventListener('click', function (e) {
        if (e.target === popup) {
          popup.remove();
        }
      });

      document.body.appendChild(popup);
    }

    // Add CSS animations
    const style = document.createElement('style');
    style.textContent = `
      @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
      }
      
      @keyframes slideUp {
      from { 
        opacity: 0;
        transform: translateY(50px) scale(0.9);
      }
      to { 
        opacity: 1;
        transform: translateY(0) scale(1);
      }
      }
    `;
    document.head.appendChild(style);

    // Fonction pour ouvrir la modal des canettes
    function openCanetteModal(productName) {
      const product = products.find(p => p.name === productName);
      if (!product || !product.options) return;

      const modal = document.getElementById('canetteModal');
      const optionsContainer = document.getElementById('canette-options');
      const modalTitle = document.getElementById('canetteModalLabel');

      modalTitle.textContent = `Choisissez votre ${productName.toLowerCase()}`;
      optionsContainer.innerHTML = '';

      // Créer les cartes pour chaque option de canette
      product.options.forEach(option => {
        const col = document.createElement('div');
        col.className = 'col-md-6 col-lg-4 mb-3';
        col.innerHTML = `
          <div class="card" style="background: var(--darker-bg); border: 1px solid var(--border-color); border-radius: 15px; transition: all 0.3s ease; cursor: pointer;" 
               onmouseover="this.style.borderColor='var(--accent-color)'; this.style.transform='translateY(-5px)'" 
               onmouseout="this.style.borderColor='var(--border-color)'; this.style.transform='translateY(0)'"
               onclick="selectCanette('${option.name}', ${option.price})">
            <div class="card-body text-center" style="padding: 20px;">
              <h6 class="card-title" style="color: var(--text-primary); margin-bottom: 10px; font-weight: 600;">${option.name}</h6>
              <p class="card-text" style="color: var(--accent-color); font-size: 18px; font-weight: bold; margin: 0;">€${option.price}</p>
            </div>
          </div>
        `;
        optionsContainer.appendChild(col);
      });

      $('#canetteModal').modal('show');
    }

    // Fonction pour sélectionner une canette et l'ajouter au panier
    function selectCanette(canetteName, price) {
      addToCart(canetteName, price);
      $('#canetteModal').modal('hide');
    }

    // Fonction pour ouvrir la modal de sélection de boisson pour les menus
    function openMenuDrinkModal(productName, basePrice) {
      const product = products.find(p => p.name === productName);
      if (!product || !product.drinkOptions) return;

      const modal = document.getElementById('menuDrinkModal');
      const optionsContainer = document.getElementById('menu-drink-options');
      const modalTitle = document.getElementById('menuDrinkModalLabel');

      modalTitle.textContent = `Choisissez votre boisson pour ${productName}`;
      optionsContainer.innerHTML = '';

      // Créer les cartes pour chaque option de boisson
      product.drinkOptions.forEach(drink => {
        const col = document.createElement('div');
        col.className = 'col-md-6 col-lg-4 mb-3';
        col.innerHTML = `
          <div class="card" style="background: var(--darker-bg); border: 1px solid var(--border-color); border-radius: 15px; transition: all 0.3s ease; cursor: pointer;" 
               onmouseover="this.style.borderColor='var(--accent-color)'; this.style.transform='translateY(-5px)'" 
               onmouseout="this.style.borderColor='var(--border-color)'; this.style.transform='translateY(0)'"
               onclick="selectMenuDrink('${productName}', ${basePrice}, '${drink.name}', ${drink.price})">
            <div class="card-body text-center" style="padding: 20px;">
              <h6 class="card-title" style="color: var(--text-primary); margin-bottom: 10px; font-weight: 600;">${drink.name}</h6>
              <p class="card-text" style="color: var(--accent-color); font-size: 16px; font-weight: bold; margin: 0;">Inclus</p>
              <small style="color: var(--text-secondary);">Dans le prix du menu</small>
            </div>
          </div>
        `;
        optionsContainer.appendChild(col);
      });

      $('#menuDrinkModal').modal('show');
    }

    // Fonction pour sélectionner une boisson et ajouter le menu complet au panier
    function selectMenuDrink(productName, basePrice, drinkName, drinkPrice) {
      // Ajouter le plat principal au panier
      addToCart(productName, basePrice);
      // Ajouter la boisson sélectionnée au panier (incluse dans le prix)
      addToCart(drinkName, 0);
      $('#menuDrinkModal').modal('hide');
    }

    // Fonctions pour gérer le localStorage
    function saveCartToLocalStorage() {
      localStorage.setItem('restaurantCart', JSON.stringify(cart));
    }

    function loadCartFromLocalStorage() {
      const savedCart = localStorage.getItem('restaurantCart');
      if (savedCart) {
        cart = JSON.parse(savedCart);
        updateCartDisplay();
      }
    }

    function clearCart() {
      cart = [];
      saveCartToLocalStorage();
      updateCartDisplay();
    }

    // Fonction pour calculer la promotion des pizzas (3 pizzas = 1 offerte)
    function calculatePizzaPromotion(cartItems) {
      // Identifier les pizzas dans le panier
      let pizzaItems = [];
      cartItems.forEach((item, index) => {
        if (item.name && item.name.toLowerCase().includes('pizza')) {
          for (let i = 0; i < item.quantity; i++) {
            pizzaItems.push({
              name: item.name,
              price: item.price,
              originalIndex: index
            });
          }
        }
      });

      // Trier les pizzas par prix croissant (les moins chères en premier)
      pizzaItems.sort((a, b) => a.price - b.price);

      // Calculer le nombre de pizzas gratuites (1 pour chaque groupe de 3)
      const freePizzas = Math.floor(pizzaItems.length / 3);

      // Calculer la réduction (somme des prix des pizzas les moins chères offertes)
      let discount = 0;
      for (let i = 0; i < freePizzas; i++) {
        discount += pizzaItems[i].price;
      }

      return {
        totalPizzas: pizzaItems.length,
        freePizzas: freePizzas,
        discount: discount
      };
    }

    // Fonction pour calculer les frais de livraison
    function calculateDeliveryFee(customerLocation, subtotal) {
      const freeDeliveryLocations = [
        'ostricourt',
        'evin malmaison',
        'leforest',
        'thumeries',
        'oignies',
        'wahagnies'
      ];

      const deliveryLocation = (customerLocation || '').toLowerCase().trim();

      // Vérifier si la localisation est dans la zone de livraison gratuite
      const isInFreeZone = freeDeliveryLocations.some(location =>
        deliveryLocation.includes(location)
      );

      // Livraison gratuite si commande >= 15€
      if (subtotal >= 15) {
        return 0;
      }

      return 3; // Prix de livraison standard
    }

    let cart = [];

    // Charger le panier au chargement de la page
    document.addEventListener('DOMContentLoaded', function () {
      loadCartFromLocalStorage();

      // Vérifier si on doit ouvrir le panier automatiquement
      const urlParams = new URLSearchParams(window.location.search);
      if (urlParams.get('openCart') === 'true') {
        // Attendre un peu que la page soit complètement chargée
        setTimeout(() => {
          const cart = document.getElementById('floating-cart');
          cart.classList.add('open');
        }, 500);
      }
    });

    function addToCart(productName, price) {
      const existingItem = cart.find(item => item.name === productName);

      if (existingItem) {
        existingItem.quantity += 1;
      } else {
        cart.push({
          name: productName,
          price: price,
          quantity: 1
        });
      }

      saveCartToLocalStorage(); // Sauvegarder le panier
      updateCartDisplay();
      showCartTemporarily();
    }

    function removeFromCart(index) {
      cart.splice(index, 1);
      saveCartToLocalStorage(); // Sauvegarder le panier
      updateCartDisplay();
    }

    function updateQuantity(index, change) {
      cart[index].quantity += change;
      if (cart[index].quantity <= 0) {
        removeFromCart(index);
      } else {
        saveCartToLocalStorage(); // Sauvegarder le panier
        updateCartDisplay();
      }
    }

    function updateCartDisplay() {
      const cartItemsContainer = document.getElementById('cart-items');
      const emptyCart = document.getElementById('empty-cart');
      const cartTotal = document.getElementById('cart-total');
      const cartCount = document.getElementById('cart-count');
      const cartToggleCount = document.getElementById('cart-toggle-count');
      const cartCountBottom = document.getElementById('cart-count-bottom');
      const checkoutBtn = document.getElementById('checkout-btn');

      if (cart.length === 0) {
        emptyCart.style.display = 'block';
        checkoutBtn.style.display = 'none';
        cartCount.style.display = 'none';
        cartToggleCount.style.display = 'none';
        if (cartCountBottom) cartCountBottom.style.display = 'none';
        cartTotal.textContent = '0';
        return;
      }

      emptyCart.style.display = 'none';
      checkoutBtn.style.display = 'block';

      let totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
      let subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);

      // Calculer la promotion des pizzas
      const pizzaPromo = calculatePizzaPromotion(cart);
      let finalTotal = subtotal - pizzaPromo.discount;

      cartCount.style.display = 'flex';
      cartToggleCount.style.display = 'flex';
      cartCount.textContent = totalItems;
      cartToggleCount.textContent = totalItems;
      cartTotal.textContent = finalTotal.toFixed(2);

      // Mettre à jour le compteur du bouton en bas
      if (cartCountBottom) {
        cartCountBottom.textContent = totalItems;
        cartCountBottom.style.display = 'flex';
      }

      // Clear existing items
      const existingItems = cartItemsContainer.querySelectorAll('.cart-item');
      existingItems.forEach(item => item.remove());

      // Add current items
      cart.forEach((item, index) => {
        const itemElement = document.createElement('div');
        itemElement.className = 'cart-item';
        itemElement.innerHTML = `
          <div class="cart-item-info">
            <div class="cart-item-name">${item.name}</div>
            <div class="cart-item-price">€${item.price} each</div>
            <div class="quantity-controls">
              <button class="quantity-btn" onclick="updateQuantity(${index}, -1)">-</button>
              <span class="quantity-display">${item.quantity}</span>
              <button class="quantity-btn" onclick="updateQuantity(${index}, 1)">+</button>
              <button class="remove-item" onclick="removeFromCart(${index})">Supprimer</button>
            </div>
          </div>
          <div class="cart-item-total">
            €${(item.price * item.quantity).toFixed(2)}
          </div>
        `;
        cartItemsContainer.appendChild(itemElement);
      });

      // Afficher la promotion des pizzas si applicable
      if (pizzaPromo.freePizzas > 0) {
        const promoElement = document.createElement('div');
        promoElement.className = 'cart-item promotion-item';
        promoElement.innerHTML = `
          <div class="cart-item-info">
            <div class="cart-item-name" style="color: #28a745; font-weight: bold;">
              🎉 Promotion: ${pizzaPromo.freePizzas} pizza${pizzaPromo.freePizzas > 1 ? 's' : ''} offerte${pizzaPromo.freePizzas > 1 ? 's' : ''}
            </div>
            <div class="cart-item-price" style="color: #28a745; font-size: 12px;">
              ${pizzaPromo.totalPizzas} pizzas → ${pizzaPromo.freePizzas} gratuite${pizzaPromo.freePizzas > 1 ? 's' : ''}
            </div>
          </div>
          <div class="cart-item-total"    style="color: #28a745; font-weight: bold;">
            -€${pizzaPromo.discount.toFixed(2)}
          </div>
        `;
        cartItemsContainer.appendChild(promoElement);
      }


    }

    function toggleCart() {
      const cart = document.getElementById('floating-cart');
      cart.classList.toggle('open');
    }

    function showCartTemporarily() {
      const cart = document.getElementById('floating-cart');
      cart.classList.add('open');
      setTimeout(() => {
        cart.classList.remove('open');
      }, 3000);
    }

    function proceedToCheckout() {
      const checkoutItems = document.getElementById('checkout-items');
      const checkoutTotal = document.getElementById('checkout-total');

      let subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
      const pizzaPromo = calculatePizzaPromotion(cart);
      let finalTotal = subtotal - pizzaPromo.discount;

      checkoutTotal.textContent = finalTotal.toFixed(2);

      checkoutItems.innerHTML = '';

      // Afficher les articles
      cart.forEach(item => {
        const itemDiv = document.createElement('div');
        itemDiv.className = 'd-flex justify-content-between mb-2';
        itemDiv.innerHTML = `
          <span>${item.name} x${item.quantity}</span>
          <span>€${(item.price * item.quantity).toFixed(2)}</span>
        `;
        checkoutItems.appendChild(itemDiv);
      });

      // Afficher la promotion si applicable
      if (pizzaPromo.freePizzas > 0) {
        const promoDiv = document.createElement('div');
        promoDiv.className = 'd-flex justify-content-between mb-2';
        promoDiv.style.color = '#28a745';
        promoDiv.style.fontWeight = 'bold';
        promoDiv.innerHTML = `
          <span>🎉 Promotion: ${pizzaPromo.freePizzas} pizza${pizzaPromo.freePizzas > 1 ? 's' : ''} offerte${pizzaPromo.freePizzas > 1 ? 's' : ''}</span>
          <span>-€${pizzaPromo.discount.toFixed(2)}</span>
        `;
        checkoutItems.appendChild(promoDiv);

        // Ligne de séparation et détail des totaux
        const separatorDiv = document.createElement('div');
        separatorDiv.className = 'border-top pt-2 mt-2';
        separatorDiv.innerHTML = `
          <div class="d-flex justify-content-between mb-1">
            <span>Sous-total:</span>
            <span>€${subtotal.toFixed(2)}</span>
          </div>
          <div class="d-flex justify-content-between font-weight-bold">
            <span>Total final:</span>
            <span style="color: #ff6b35;">€${finalTotal.toFixed(2)}</span>
          </div>
        `;
        checkoutItems.appendChild(separatorDiv);
      }

      $('#checkoutModal').modal('show');
    }

    function submitOrder() {
      const customerName = document.getElementById('customerName').value;
      const customerEmail = document.getElementById('customerEmail').value;
      const customerPhone = document.getElementById('customerPhone').value;
      const customerLocation = document.getElementById('customerLocation').value;

      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      const phoneRegex = /^[0-9]{10}$/;
      const nameRegex = /^[a-zA-Z\s]+$/;

      if (!customerName || !customerEmail || !customerPhone || !customerLocation) {
        alert('Please fill in all customer information fields');
        return;
      }

      if (!nameRegex.test(customerName)) {
        alert('Name should not contain numbers or special characters');
        return;
      }

      if (!emailRegex.test(customerEmail)) {
        alert('Please enter a valid email address');
        return;
      }
      // Contrôle numéro français (commence par 0 ou +33, puis 9 chiffres)
      const frenchPhoneRegex = /^(0|\+33)[1-9](\d{8})$/;
      if (!frenchPhoneRegex.test(customerPhone)) {
        alert('Veuillez entrer un numéro de téléphone français valide (ex: 0612345678 ou +33612345678)');
        return;
      }

      // if (!phoneRegex.test(customerPhone)) {
      //   alert('Please enter a valid 10-digit phone number');
      //   return;
      // }

      const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
      const pizzaPromo = calculatePizzaPromotion(cart);
      const deliveryFee = calculateDeliveryFee(customerLocation, subtotal);
      const finalTotal = subtotal - pizzaPromo.discount + deliveryFee;

      const orderData = {
        items: cart,
        totalPrice: finalTotal, // Prix final avec promotion et livraison
        subtotal: subtotal, // Sous-total avant promotion et livraison
        pizzaDiscount: pizzaPromo.discount, // Montant de la réduction
        freePizzas: pizzaPromo.freePizzas, // Nombre de pizzas offertes
        deliveryFee: deliveryFee, // Frais de livraison
        customerName: customerName,
        customerEmail: customerEmail,
        customerPhone: customerPhone,
        customerLocation: customerLocation,
        orderDate: firebase.firestore.FieldValue.serverTimestamp(),
        paymentStatus: 'pending'
      };

      db.collection('orders').add(orderData)
        .then((docRef) => {
          // Notification interne


          // === Préparation du message Telegram ===
          let message =
            `🍽️ *Nouvelle commande reçue*\n\n` +
            `👤 *Client :* ${customerName}\n` +
            `📧 *Email :* ${customerEmail}\n` +
            `📱 *Téléphone :* ${customerPhone}\n` +
            `📍 *Adresse :* ${customerLocation}\n\n` +
            `🛒 *Articles :*\n` +
            cart
              .map(
                (item) => `• ${item.name} x${item.quantity} - ${(item.price * item.quantity).toFixed(2)} €`
              )
              .join("\n");

          // Ajouter les informations de promotion si applicable
          if (pizzaPromo.freePizzas > 0) {
            message += `\n\n🎉 *Promotion :* ${pizzaPromo.freePizzas} pizza${pizzaPromo.freePizzas > 1 ? 's' : ''} offerte${pizzaPromo.freePizzas > 1 ? 's' : ''}`;
            message += `\n� *Sous-total :* ${subtotal.toFixed(2)} €`;
            message += `\n💸 *Réduction :* -${pizzaPromo.discount.toFixed(2)} €`;
          }

          // Ajouter les frais de livraison
          const deliveryText = deliveryFee === 0 ? 'GRATUITE' : `${deliveryFee.toFixed(2)} €`;
          message += `\n🚚 *Livraison :* ${deliveryText}`;

          message += `\n\n💰 *Total final : ${finalTotal.toFixed(2)} €*\n` +
            `📅 *ID de commande :* ${docRef.id}`;


          sendTelegramMessage(message);
          sendEmailMessage(orderData, docRef);
          // Function to create Stripe session via backend API
          function createStripePayment(orderId, orderData) {
            try {
              const checkoutData = {
                orderId,
                total: orderData.totalPrice,
                subtotal: orderData.subtotal,
                deliveryFee: orderData.deliveryFee,
                pizzaDiscount: orderData.pizzaDiscount,
                freePizzas: orderData.freePizzas,
                items: orderData.items,
                customerName: orderData.customerName,
                customerEmail: orderData.customerEmail,
                customerPhone: orderData.customerPhone,
                customerLocation: orderData.customerLocation
              };
              sessionStorage.setItem('checkoutData', JSON.stringify(checkoutData));
              window.location.href = 'html.html?orderId=' + encodeURIComponent(orderId);
            } catch (e) {
              console.error('Failed to init payment redirect', e);
              alert('Error preparing payment. Please try again.');
            }
          }

          // Call the payment page redirection function
          createStripePayment(docRef.id, orderData);


          // Fonction d’envoi vers Telegram
          async function sendTelegramMessage(message) {
            // chatId argument is ignored because the server-side API uses the CHAT_ID env var.
            try {
              const res = await fetch('/api/send', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ message })
              });

              const data = await res.json();

              if (res.ok) {
                console.log('📱 Telegram message requested via backend:', data);
              } else {
                console.error('❌ Backend failed to send Telegram message:', data);
              }

              return data;
            } catch (error) {
              console.error('⚠️ Error calling backend Telegram endpoint:', error);
              return null;
            }
          } function sendEmailMessage(orderData, docRef) {
            // Build a plain-text fallback message (nodemailer handler expects `text`)
            const itemsText = cart
              .map(item => `• ${item.name} x${item.quantity} - €${(item.price * item.quantity).toFixed(2)}`)
              .join("\n");

            const emailText = [
              '🍽️ Nouvelle commande reçue',
              '',
              `Client : ${orderData.customerName}`,
              `Email : ${orderData.customerEmail}`,
              `Téléphone : ${orderData.customerPhone}`,
              `Adresse : ${orderData.customerLocation}`,
              '',
              'Articles :',
              itemsText,
              '',
              `Total : ${orderData.totalPrice} €`,
              `ID de commande : ${docRef.id}`,
              `Heure de commande : ${new Date().toLocaleString()}`
            ].join('\n');


            const payload = {
              to: 'speranza.ostricourt@gmail.com',
              subject: `🍽️ Nouvelle commande #${docRef.id} - Speranza Pizza`,
              text: emailText
            };

            // Send email via your backend API endpoint (Next.js API route)
            fetch('/api/send-email', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json'
              },
              body: JSON.stringify(payload)
            })
              .then(res => res.json())
              .then(data => {
                if (data.success) {
                  console.log('✅ Email sent successfully to boss!');
                } else {
                  console.warn('❌ Failed to send email:', data.error || data);
                }
              })
              .catch(err => {
                console.error('❌ Email sending error:', err);
                // Fallback: log the order details for manual processing
                console.log('📧 Order notification data:', payload);
              });
          }
          // sendEmailMessage(orderData, docRef);  

          // === Success user feedback ===
          alert("✅ Commande passée avec succès ! Nous vous contacterons bientôt.");

          // Vider le panier et fermer la modal
          cart = [];
          updateCartDisplay();
          $("#checkoutModal").modal("hide");
          $("#floating-cart").removeClass("open");

          // Reset form
          document.getElementById("checkoutForm").reset();
        })

        .catch((error) => {
          console.error('Error submitting order:', error);
          alert('Error placing order. Please try again.');
        });
    }

    // --- Post Stripe return payment handler ---
    async function handlePostPayment() {
      const params = new URLSearchParams(window.location.search);
      const status = params.get('payment');
      const orderId = params.get('orderId');
      if (!orderId || !status) return;

      const flagKey = 'paymentConfirmed-' + orderId;
      if (status === 'success') {
        if (sessionStorage.getItem(flagKey)) return;

        // Spinner & message
        let spinner = document.createElement('div');
        spinner.id = 'payment-spinner';
        spinner.style = 'position:fixed;top:20px;left:50%;transform:translateX(-50%);background:#222;color:#fff;padding:18px 36px;border-radius:10px;z-index:9999;font-size:18px;display:flex;align-items:center;gap:12px;';
        spinner.innerHTML = '<span class="fa fa-spinner fa-spin"></span> <span id="payment-msg">Confirmation du paiement...</span>';
        document.body.appendChild(spinner);

        let attempts = 0, maxAttempts = 6, delay = 600, updated = false;
        const dbRef = () => ensureFirebase().then(db => db.collection('orders').doc(orderId));

        async function tryUpdate() {
          attempts++;
          try {
            await dbRef().then(ref => ref.update({
              paymentStatus: 'paid',
              paymentConfirmedAt: firebase.firestore.FieldValue.serverTimestamp()
            }));
            updated = true;
            sessionStorage.setItem(flagKey, '1');
            document.getElementById('payment-msg').textContent = '✅ Paiement confirmé. Merci !';
            spinner.style.background = '#28a745';
            setTimeout(() => spinner.remove(), 1800);
          } catch (err) {
            if (attempts < maxAttempts) {
              document.getElementById('payment-msg').textContent = `Tentative ${attempts}/${maxAttempts}...`;
              setTimeout(tryUpdate, delay);
              delay *= 1.5;
            } else {
              document.getElementById('payment-msg').textContent = '⚠️ Paiement confirmé, mais la mise à jour a échoué. Contactez le support.';
              spinner.style.background = '#dc3545';
              setTimeout(() => spinner.remove(), 4000);
              console.error('Firestore update failed after retries', err);
            }
          }
        }

        // Timeout global pour éviter de bloquer l'utilisateur
        setTimeout(() => {
          if (!updated) {
            document.getElementById('payment-msg').textContent = '⚠️ Confirmation trop lente. Vérifiez votre commande ou contactez le support.';
            spinner.style.background = '#ffc107';
            setTimeout(() => spinner.remove(), 5000);
          }
        }, 9000);

        tryUpdate();
      } else if (status === 'cancelled') {
        ensureFirebase().then(db => db.collection('orders').doc(orderId).update({
          paymentStatus: 'cancelled'
        })).catch(() => { });
      }
    }

    document.addEventListener('DOMContentLoaded', function () {
      // ...existing code for filters...
      loadProducts();
      handlePostPayment();
    });
  </script>

  <!-- footer section -->
  <footer class="footer_section">
    <div class="container">
      <div class="row">
        <div class="col-md-4 footer-col">
          <div class="footer_contact">
            <h4>Nous Contacter</h4>
            <div class="contact_link_box">
              <a href="https://maps.google.com/?q=80+Place+de+la+République,+Ostricourt+59162,+France" target="_blank">
                <span>80 Place de la République, Ostricourt 59162, France</span>
              </a>
              <a href="tel:+033764875254">
                <span>Appelez 07 64 87 52 54 / 03 59 43 47 18</span>
              </a>
              <a href="mailto:speranza.ostricourt@gmail.com">
                <span>speranza.ostricourt@gmail.com</span>
              </a>
            </div>
          </div>
        </div>
        <div class="col-md-4 footer-col">
          <div class="footer_detail">
            <a href="" class="footer-logo">Speranza Pizza</a>
            <p>
              Chez Speranza Pizza, nous sommes fiers de servir des repas délicieux et fraîchement préparés avec les
              meilleurs ingrédients. De nos pizzas signature à nos burgers savoureux et nos pâtes, chaque plat est conçu
              pour ravir vos papilles et créer des expériences culinaires inoubliables.
            </p>
            <div class="footer_social">
              <a href="https://www.facebook.com/profile.php?id=61580148713448"><i class="fa fa-facebook"
                  aria-hidden="true"></i></a>
              <a href="https://www.instagram.com/speranza.pizza/"><i class="fa fa-instagram" aria-hidden="true"></i></a>
            </div>
          </div>
        </div>
        <div class="col-md-4 footer-col">
          <h4>Horaires d'Ouverture</h4>
          <p>Lun–Jeu, Sam–Dim : 11h00 – 14h00 et 18h00 – 23h00</p>
          <p>Vendredi : 18h00 – 23h00</p>
        </div>
      </div>
      <div class="footer-info">
        <p>&copy; <span id="displayYear"></span> Tous Droits Réservés Par <a href="https://html.design/">MM
            Developers</a><br><br></p>
      </div>
    </div>
  </footer>

  <!-- Bouton panier flottant en bas -->
  <button class="floating-cart-button-bottom" id="floating-cart-btn-bottom" onclick="toggleCart()">
    <i class="fa fa-shopping-cart"></i>
    <span id="cart-count-bottom" class="cart-count-badge-bottom">0</span>
  </button>

  <style>
    /* Hide the button by default */
    .floating-cart-button-bottom {
      display: none;
    }

    /* Show only on mobile devices (max-width: 768px) */
    @media (max-width: 768px) {
      .floating-cart-button-bottom {
        display: flex !important;
      }
    }
  </style>

  <!-- Scripts -->
  <script src="js/jquery-3.4.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
  <script src="js/bootstrap.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>
  <script src="https://unpkg.com/isotope-layout@3.0.4/dist/isotope.pkgd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-nice-select/1.1.0/js/jquery.nice-select.min.js"></script>
  <script src="menu-pizzas.js"></script>
  <script src="js/custom.js"></script>
</body>

</html>